---
title: "Enduse Energy Carrier Prices"
output:
  pdf_document:
    toc: yes
    toc_depth: '2'
  html_document:
    toc: yes
    toc_depth: 2
---

<style type="text/css">

h1.title {
  font-size: 26px;
}
h1 { /* Header 1 */
  font-size: 22px;
}
h2 { /* Header 2 */
    font-size: 20px;
}
h3 { /* Header 3 */
  font-size: 18px;
  font-family: "Times New Roman", Times, serif;
}

</style>





```{r , include=FALSE}
knitr::opts_chunk$set(
  echo = FALSE,
  error = TRUE,
  message = FALSE)
```

```{r , include=FALSE}
library(data.table)
library(readxl)
library(ggplot2)
```


```{r , include=FALSE}
Pathtofile <- "C:/Users/johannah/Documents/Projects/ACEA Projekt/TCO_Calculations/Customer_FuelP_kwh_.csv"

TypePrices_Customer <- fread(Pathtofile)


TypePrices_Customer_plotting <- copy(TypePrices_Customer)

TypePrices_Customer_plotting[Parameter %in% c("Electricity Price", "MCS Station (Public Charging) - Incl. Overhead", "MCS grid extension", "MCS Profit and Mark-Up", "Network Costs - MCS", "Taxes, Fees, Levies and charges - MCS"), Type := "Electricity MCS"]

TypePrices_Customer_plotting[Parameter %in% c("Electricity Price", "CCS Station (Depot) - Incl. Overhead", "CCS grid extension", "Network Costs - Depot", "Taxes, Fees, Levies and charges - Depot", "Depot - Network fees savings potential"), Type := "Electricity CCS Depot"]


TypePrices_Customer_plotting[grepl("LNG", Parameter) | Parameter == "Total NG Mark-Up", Type := "LNG"]

TypePrices_Customer_plotting[grepl("H2|Hydrogen|HRS", Parameter), Type := "Hydrogen"]

TypePrices_Customer_plotting[, `Fuel-Scenario` := factor(`Fuel-Scenario`, levels = c("Electricity", "Hydrogen", "Low Carbon Fuels"))]

Hydrogen <- TypePrices_Customer_plotting[Type == "Hydrogen"]
Hydrogen[Parameter == "Hydrogen Price", Parameter := "Wholesale Hydrogen Price"]

Hydrogen[, Parameter := factor(Parameter, levels = c("HRS Overhead, Profit and Mark-Up","HRS costs","Taxes, Fees, Levies and charges - H2", "H2 transport and distribution",  "Wholesale Hydrogen Price"))]

Electricity_MCS <- TypePrices_Customer_plotting[Type == "Electricity MCS"]
Electricity_MCS_ws <- copy(TypePrices_Customer_plotting[Parameter == "Electricity Price"])
Electricity_MCS_ws[, Type := "Electricity MCS"]
Electricity_MCS <- rbind(Electricity_MCS, Electricity_MCS_ws)
Electricity_MCS[Parameter == "Electricity Price", Parameter := "Wholesale Electricity Price"]
Electricity_MCS <- Electricity_MCS[, Parameter := factor(Parameter, levels = c(  "MCS Profit and Mark-Up", "MCS grid extension", "MCS Station (Public Charging) - Incl. Overhead", "Taxes, Fees, Levies and charges - MCS", "Network Costs - MCS",  "Wholesale Electricity Price"))]

Electricity_Depot <- TypePrices_Customer_plotting[Type == "Electricity CCS Depot"]
Electricity_Depot[Parameter ==  "Depot - Network fees savings potential", Parameter := "Network Costs - Depot"]
Electricity_Depot <- Electricity_Depot[, .(value = sum(value)), by = c("Parameter","Country", "Fuel-Scenario", "Unit", "period", "Type")]
Electricity_Depot[Parameter == "Electricity Price", Parameter := "Wholesale Electricity Price"]
Electricity_Depot  <- Electricity_Depot[, Parameter := factor(Parameter, levels = c("CCS grid extension",  "CCS Station (Depot) - Incl. Overhead", "Taxes, Fees, Levies and charges - Depot", "Network Costs - Depot", "Wholesale Electricity Price"))]

Diesel_Mix <- TypePrices_Customer_plotting[Parameter %in% c("Diesel Mix Price", "Total Diesel Mark-Up", "CO2 Tax Diesel Mix", "Excise Duty - Diesel Mix")]
Diesel_Mix[Parameter == "Diesel Mix Price", Parameter := "Wholesale Diesel Price (Mix)"][, Type := "Diesel Mix"]
Diesel_Mix <- Diesel_Mix[, Parameter := factor(Parameter, levels = c( "Total Diesel Mark-Up", "CO2 Tax Diesel Mix", "Excise Duty - Diesel Mix", "Wholesale Diesel Price (Mix)"))]

Diesel <- TypePrices_Customer_plotting[Parameter %in% c("Diesel Price", "Total Diesel Mark-Up", "CO2 Tax Diesel", "Excise Duty - Diesel")]
Diesel[Parameter == "Diesel Price", Parameter := "Wholesale Diesel Price"][, Type := "Fossil Diesel"]
Diesel <- Diesel[, Parameter := factor(Parameter, levels = c( "Total Diesel Mark-Up", "CO2 Tax Diesel", "Excise Duty - Diesel", "Wholesale Diesel Price"))]

PtDiesel <- TypePrices_Customer_plotting[Parameter %in% c("Pt-Diesel Price", "Total Diesel Mark-Up", "CO2 Tax Pt-Diesel", "Excise Duty - Synthetic Diesel (E-Fuels)")]
PtDiesel[Parameter == "Pt-Diesel Price", Parameter := "Wholesale PT-Diesel Price"]
PtDiesel <- PtDiesel[, Parameter := factor(Parameter, levels = c( "Total Diesel Mark-Up", "CO2 Tax Pt-Diesel", "Excise Duty - Synthetic Diesel (E-Fuels)", "Wholesale PT-Diesel Price"))][, Type := "PT Diesel"]

BioDiesel <- TypePrices_Customer_plotting[Parameter %in% c("Biodiesel Price", "Total Diesel Mark-Up", "CO2 Tax Biodiesel", "Excise Duty - biodiesel")]
BioDiesel[Parameter == "Biodiesel Price", Parameter := "Wholesale Biodiesel Price"][, Type := "Bio Diesel"]
BioDiesel <- BioDiesel[, Parameter := factor(Parameter, levels = c( "Total Diesel Mark-Up", "CO2 Tax Biodiesel", "Excise Duty - biodiesel", "Wholesale Biodiesel Price"))]

LNG_Mix <- TypePrices_Customer_plotting[Parameter %in% c("LNG Mix Price", "Total NG Mark-Up", "CO2 Tax LNG Mix", "Excise Duty - LNG Mix")]
LNG_Mix[Parameter == "LNG Mix Price", Parameter := "Wholesale LNG Price (Mix)"][, Type := "LNG Mix"]
LNG_Mix <- LNG_Mix[, Parameter := factor(Parameter, levels = c("Total NG Mark-Up", "CO2 Tax LNG Mix", "Excise Duty - LNG Mix", "Wholesale LNG Price (Mix)"))]

LNG <- TypePrices_Customer_plotting[Parameter %in% c("LNG Price", "Total NG Mark-Up", "CO2 Tax LNG", "Excise Duty - LNG")]
LNG[Parameter == "LNG Price", Parameter := "Wholesale LNG Price"][, Type := "Fossil LNG"]
LNG <- LNG[, Parameter := factor(Parameter, levels = c("Total NG Mark-Up", "CO2 Tax LNG", "Excise Duty - LNG", "Wholesale LNG Price"))]

PtLNG <- TypePrices_Customer_plotting[Parameter %in% c("Pt-LNG Price", "Total NG Mark-Up", "CO2 Tax Pt-LNG", "Excise Duty - Pt-LNG")]
PtLNG[Parameter == "Pt-LNG Price", Parameter := "Wholesale Pt-LNG Price"][, Type := "PT LNG"]
PtLNG <- PtLNG[, Parameter := factor(Parameter, levels = c("Total NG Mark-Up", "CO2 Tax Pt-LNG", "Excise Duty - Pt-LNG", "Wholesale Pt-LNG Price"))]

BioLNG <- TypePrices_Customer_plotting[Parameter %in% c("Biogas Price", "Total NG Mark-Up", "CO2 Tax Biogas", "Excise Duty - biogas")]
BioLNG[Parameter == "Biogas Price", Parameter := "Wholesale Biogas Price"][, Type := "Bio Gas"]
BioLNG <- BioLNG[, Parameter := factor(Parameter, levels = c("Total NG Mark-Up", "CO2 Tax Biogas", "Excise Duty - biogas", "Wholesale Biogas Price"))]

Markup <- '#99916b'
CO2Tax <- '#e8d579'
GridExten <- '#bab473'
Charger <- '#ebb491'
otherTax <- '#e37552'
NetworkCost <- '#a64728'
EC_price <- '#6b1d1d'

colorbarHydrogen <- c(Markup, Charger, otherTax,  NetworkCost,  EC_price)
colorbarElec_MCS <- c(Markup, GridExten, Charger,otherTax, NetworkCost, EC_price)
colorbarElec_CCS <- c(GridExten, Charger,otherTax, NetworkCost, EC_price)
colorbarDie <- c(Markup, CO2Tax, otherTax, EC_price)
colorbarLNG <- c(Markup, CO2Tax, otherTax, EC_price)

textSize <- 35

```


# Germany
## Hydrogen Enduse Prices [EUR/kWh]
```{r , include=TRUE, fig.width = 30,fig.height = 10}
Countries_plotted <- c("DE")
yrs <- c(2030, 2040, 2050)
```

```{r , include=TRUE, fig.width = 30,fig.height = 10}
p <- ggplot(Hydrogen[Country %in% Countries_plotted & period %in% yrs], aes(fill=Parameter, y=value, x=`period`)) + theme(panel.grid.major=element_line(colour='#adadad'), panel.grid.minor=element_line(colour='#adadad')) +
    geom_bar(position="stack", stat="identity")+
      facet_grid(~ `Fuel-Scenario`, scales = "free")+
      theme(text = element_text(size = textSize))+
      labs(y = paste0("Hydrogen Price [EUR/kWh]")) + #, title = "Hydrogen Prices for different Fuel Scenarios") +
      scale_x_continuous(breaks = c(2030, 2040, 2050)) +
      scale_fill_manual(values=colorbarHydrogen)
plot(p)

```

## Hydrogen Enduse Prices [EUR/kg]
```{r , include=TRUE, fig.width = 30,fig.height = 10}
HydrogenKg <- copy(Hydrogen)
HydrogenKg[, `kWh/kg H2` := 33.33]
HydrogenKg[, value := value*`kWh/kg H2`][, unit := "EUR/kg"]

p <- ggplot(HydrogenKg[Country %in% Countries_plotted & period %in% yrs], aes(fill=Parameter, y=value, x=`period`)) + theme(panel.grid.major=element_line(colour='#adadad'), panel.grid.minor=element_line(colour='#adadad')) +
    geom_bar(position="stack", stat="identity")+
      facet_grid(~ `Fuel-Scenario`, scales = "free")+
      theme(text = element_text(size = textSize))+
      labs(y = paste0("Hydrogen Price [EUR/kg]")) + #, title = "Hydrogen Prices for different Fuel Scenarios") +
      scale_x_continuous(breaks = c(2030, 2040, 2050)) +
      scale_fill_manual(values=colorbarHydrogen)
plot(p)

```

## Electricity Enduse Prices Depot Charging [EUR/kWh]
```{r , include=TRUE, fig.width = 30,fig.height = 10}
p <- ggplot(Electricity_Depot[Country %in% Countries_plotted & period %in% yrs], aes(fill=Parameter, y=value, x=`period`)) + theme(panel.grid.major=element_line(colour='#adadad'), panel.grid.minor=element_line(colour='#adadad')) +
    geom_bar(position="stack", stat="identity")+
      facet_grid(~ `Fuel-Scenario`, scales = "free")+
      theme(text = element_text(size = textSize))+
      labs(y = paste0("Enduse Electricity Price [EUR/kWh]")) + #, title = "Electricity Prices Depot Charging") +
      scale_x_continuous(breaks = c(2030, 2040, 2050)) +
      scale_fill_manual(values=colorbarElec_CCS)
plot(p)

```

## Electricity Enduse Prices MCS Charging [EUR/kWh]
```{r , include=TRUE, fig.width = 30,fig.height = 10}
p <- ggplot(Electricity_MCS[Country %in% Countries_plotted & period %in% yrs], aes(fill=Parameter, y=value, x=`period`)) + theme(panel.grid.major=element_line(colour='#adadad'), panel.grid.minor=element_line(colour='#adadad')) +
    geom_bar(position="stack", stat="identity")+
      facet_grid(~ `Fuel-Scenario`, scales = "free")+
      theme(text = element_text(size = textSize))+
      labs(y = paste0("Enduse Electricity Price [EUR/kWh]")) + #, title = "Electricity Prices MCS Charging") +
      scale_x_continuous(breaks = c(2030, 2040, 2050)) +
      scale_fill_manual(values=colorbarElec_MCS)
plot(p)

```

## Diesel Mix Enduse Prices [EUR/kWh]
```{r , include=TRUE, fig.width = 30,fig.height = 10}
p <- ggplot(Diesel_Mix[Country %in% Countries_plotted & period %in% yrs], aes(fill=Parameter, y=value, x=`period`)) + theme(panel.grid.major=element_line(colour='#adadad'), panel.grid.minor=element_line(colour='#adadad')) +
    geom_bar(position="stack", stat="identity")+
      facet_grid(~ `Fuel-Scenario`, scales = "free")+
      theme(text = element_text(size = textSize))+
      labs(y = paste0("Enduse Diesel Mix Price [EUR/kWh]")) + #, title = "Diesel Mix Prices") +
      scale_x_continuous(breaks = c(2030, 2040, 2050)) +
      scale_fill_manual(values=colorbarDie)
plot(p)

```

## Fossil Diesel Enduse Prices [EUR/kWh]
```{r , include=TRUE, fig.width = 30,fig.height = 10}
p <- ggplot(Diesel[Country %in% Countries_plotted & period %in% yrs], aes(fill=Parameter, y=value, x=`period`)) + theme(panel.grid.major=element_line(colour='#adadad'), panel.grid.minor=element_line(colour='#adadad')) +
    geom_bar(position="stack", stat="identity")+
      facet_grid(~ `Fuel-Scenario`, scales = "free")+
      theme(text = element_text(size = textSize))+
      labs(y = paste0("Enduse Fossil Diesel Price [EUR/kWh]")) + #, title = "Diesel Mix Prices") +
      scale_x_continuous(breaks = c(2030, 2040, 2050)) +
      scale_fill_manual(values=colorbarDie)
plot(p)

```

## Pt-Diesel Enduse Prices [EUR/kWh]
```{r , include=TRUE, fig.width = 30,fig.height = 10}
p <- ggplot(PtDiesel[Country %in% Countries_plotted & period %in% yrs], aes(fill=Parameter, y=value, x=`period`)) + theme(panel.grid.major=element_line(colour='#adadad'), panel.grid.minor=element_line(colour='#adadad')) +
    geom_bar(position="stack", stat="identity")+
      facet_grid(~ `Fuel-Scenario`, scales = "free")+
      theme(text = element_text(size = textSize))+
      labs(y = paste0("Enduse Pt-Diesel Price [EUR/kWh]")) + #, title = "Diesel Mix Prices") +
      scale_x_continuous(breaks = c(2030, 2040, 2050)) +
      scale_fill_manual(values=colorbarDie)
plot(p)

```

## Biodiesel Enduse Prices [EUR/kWh]
```{r , include=TRUE, fig.width = 30,fig.height = 10}
p <- ggplot(BioDiesel[Country %in% Countries_plotted & period %in% yrs], aes(fill=Parameter, y=value, x=`period`)) + theme(panel.grid.major=element_line(colour='#adadad'), panel.grid.minor=element_line(colour='#adadad')) +
    geom_bar(position="stack", stat="identity")+
      facet_grid(~ `Fuel-Scenario`, scales = "free")+
      theme(text = element_text(size = textSize))+
      labs(y = paste0("Enduse Biodiesel Price [EUR/kWh]")) + #, title = "Diesel Mix Prices") +
      scale_x_continuous(breaks = c(2030, 2040, 2050)) +
      scale_fill_manual(values=colorbarDie)
plot(p)

```

## LNG Mix Enduse Prices [EUR/kWh]
```{r , include=TRUE, fig.width = 30,fig.height = 10}
p <- ggplot(LNG_Mix[Country %in% Countries_plotted & period %in% yrs], aes(fill=Parameter, y=value, x=`period`)) + theme(panel.grid.major=element_line(colour='#adadad'), panel.grid.minor=element_line(colour='#adadad')) +
    geom_bar(position="stack", stat="identity")+
      facet_grid(~ `Fuel-Scenario`, scales = "free")+
      theme(text = element_text(size = textSize))+
      labs(y = paste0("Enduse LNG Mix Price [EUR/kWh]")) + #, title = "LNG Mix Prices") +
      scale_x_continuous(breaks = c(2030, 2040, 2050)) +
      scale_fill_manual(values=colorbarLNG)
plot(p)
```

## Fossil LNG Enduse Prices [EUR/kWh]
```{r , include=TRUE, fig.width = 30,fig.height = 10}
p <- ggplot(LNG[Country %in% Countries_plotted & period %in% yrs], aes(fill=Parameter, y=value, x=`period`)) + theme(panel.grid.major=element_line(colour='#adadad'), panel.grid.minor=element_line(colour='#adadad')) +
    geom_bar(position="stack", stat="identity")+
      facet_grid(~ `Fuel-Scenario`, scales = "free")+
      theme(text = element_text(size = textSize))+
      labs(y = paste0("Enduse Fossil LNG Price [EUR/kWh]")) + #, title = "Diesel Mix Prices") +
      scale_x_continuous(breaks = c(2030, 2040, 2050)) +
      scale_fill_manual(values=colorbarDie)
plot(p)

```

## Pt-LNG Enduse Prices [EUR/kWh]
```{r , include=TRUE, fig.width = 30,fig.height = 10}
p <- ggplot(PtLNG[Country %in% Countries_plotted & period %in% yrs], aes(fill=Parameter, y=value, x=`period`)) + theme(panel.grid.major=element_line(colour='#adadad'), panel.grid.minor=element_line(colour='#adadad')) +
    geom_bar(position="stack", stat="identity")+
      facet_grid(~ `Fuel-Scenario`, scales = "free")+
      theme(text = element_text(size = textSize))+
      labs(y = paste0("Enduse Pt-LNG Price [EUR/kWh]")) + #, title = "Diesel Mix Prices") +
      scale_x_continuous(breaks = c(2030, 2040, 2050)) +
      scale_fill_manual(values=colorbarDie)
plot(p)

```

## Biogas Enduse Prices [EUR/kWh]
```{r , include=TRUE, fig.width = 30,fig.height = 10}
p <- ggplot(BioLNG[Country %in% Countries_plotted & period %in% yrs], aes(fill=Parameter, y=value, x=`period`)) + theme(panel.grid.major=element_line(colour='#adadad'), panel.grid.minor=element_line(colour='#adadad')) +
    geom_bar(position="stack", stat="identity")+
      facet_grid(~ `Fuel-Scenario`, scales = "free")+
      theme(text = element_text(size = textSize))+
      labs(y = paste0("Enduse Biogas Price [EUR/kWh]")) + #, title = "Diesel Mix Prices") +
      scale_x_continuous(breaks = c(2030, 2040, 2050)) +
      scale_fill_manual(values=colorbarDie)
plot(p)

```

## Comparison plots Diesel: Fossil vs Bio vs Syn vs Mix [EUR/kWh]
```{r , include=TRUE, fig.width = 30,fig.height = 10}

yrs <- c(2020, 2030, 2035, 2040)
plotdata <- rbind(BioDiesel,PtDiesel, Diesel, Diesel_Mix)
plotdata[Parameter %in% c("Total Diesel Mark-Up"), Parameter := "Total Mark-Up"]
plotdata[Parameter %in% c("Wholesale Biodiesel Price", "Wholesale PT-Diesel Price", "Wholesale Diesel Price", "Wholesale Diesel Price (Mix)"), Parameter := "Wholesale Price"]
plotdata[Parameter %in% c("CO2 Tax Biodiesel", "CO2 Tax Pt-Diesel", "CO2 Tax Diesel", "CO2 Tax Diesel Mix"), Parameter := "CO2 Tax"]
plotdata[Parameter %in% c("Excise Duty - biodiesel", "Excise Duty - Synthetic Diesel (E-Fuels)", "Excise Duty - Diesel", "Excise Duty - Diesel Mix"), Parameter := "Excise Duty"]
plotdata <- plotdata[, Parameter := factor(Parameter, levels = c( "Total Mark-Up", "CO2 Tax", "Excise Duty", "Wholesale Price"))]
plotdata[, `Type` := factor(`Type`, levels = c("Fossil Diesel", "Bio Diesel", "PT Diesel", "Diesel Mix"))]
#Set PT-Diesel Price to zero in 2020 because there is not quantity
plotdata[period == 2020 & Type == "PT Diesel", value := 0]

p <- ggplot(plotdata[Country %in% Countries_plotted & period %in% yrs], aes(fill=Parameter, y=value, x=`Type`)) + theme(panel.grid.major=element_line(colour='#adadad'), panel.grid.minor=element_line(colour='#adadad')) +
    geom_bar(position="stack", stat="identity")+
      facet_wrap(`Fuel-Scenario` ~ period, nrow = 1, scales = "free")+
      facet_grid(`Fuel-Scenario` ~ period) + theme_bw()+
      theme(text = element_text(size = textSize))+
      scale_x_discrete(labels=function(x){sub("\\s", "\n", x)}) +
      labs(y = paste0("Diesel Prices [EUR/kWh]")) + #, title = "Diesel Mix Prices") +
      scale_fill_manual(values=colorbarDie)
plot(p)

```

## Comparison plots Diesel: Fossil vs Bio vs Syn vs Mix [EUR/l]
```{r , include=TRUE, fig.width = 30,fig.height = 10}
Diesel_kWh_pro_l <- 9.97
BioDiesel_kWh_pro_l <- 9.11

yrs <- c(2020, 2030, 2035, 2040)
plotdata <- rbind(BioDiesel,PtDiesel, Diesel, Diesel_Mix)
plotdata[, value := ifelse(Type== "Biodiesel", value*BioDiesel_kWh_pro_l, value*Diesel_kWh_pro_l)][, unit := "EUR/l"]
plotdata[Parameter %in% c("Total Diesel Mark-Up"), Parameter := "Total Mark-Up"]
plotdata[Parameter %in% c("Wholesale Biodiesel Price", "Wholesale PT-Diesel Price", "Wholesale Diesel Price", "Wholesale Diesel Price (Mix)"), Parameter := "Wholesale Price"]
plotdata[Parameter %in% c("CO2 Tax Biodiesel", "CO2 Tax Pt-Diesel", "CO2 Tax Diesel", "CO2 Tax Diesel Mix"), Parameter := "CO2 Tax"]
plotdata[Parameter %in% c("Excise Duty - biodiesel", "Excise Duty - Synthetic Diesel (E-Fuels)", "Excise Duty - Diesel", "Excise Duty - Diesel Mix"), Parameter := "Excise Duty"]
plotdata <- plotdata[, Parameter := factor(Parameter, levels = c( "Total Mark-Up", "CO2 Tax", "Excise Duty", "Wholesale Price"))]
plotdata[, `Type` := factor(`Type`, levels = c("Fossil Diesel", "Bio Diesel", "PT Diesel", "Diesel Mix"))]
#Set PT-Diesel Price to zero in 2020 because there is not quantity
plotdata[period == 2020 & Type == "PT Diesel", value := 0]

p <- ggplot(plotdata[Country %in% Countries_plotted & period %in% yrs], aes(fill=Parameter, y=value, x=`Type`)) + theme(panel.grid.major=element_line(colour='#adadad'), panel.grid.minor=element_line(colour='#adadad')) +
    geom_bar(position="stack", stat="identity")+
      facet_wrap(`Fuel-Scenario` ~ period, nrow = 1, scales = "free")+
      facet_grid(`Fuel-Scenario` ~ period) + theme_bw()+
      theme(text = element_text(size = textSize))+
      scale_x_discrete(labels=function(x){sub("\\s", "\n", x)}) +
      labs(y = paste0("Diesel Prices [EUR/l]")) + #, title = "Diesel Mix Prices") +
      scale_fill_manual(values=colorbarDie)
plot(p)

```

## Comparison plots LNG: Fossil vs Bio vs Syn vs Mix [EUR/kWh]
```{r , include=TRUE, fig.width = 30,fig.height = 10}
yrs <- c(2020, 2030, 2035, 2040)
plotdata <- rbind(BioLNG,PtLNG, LNG, LNG_Mix)
plotdata[Parameter %in% c("Total NG Mark-Up"), Parameter := "Total Mark-Up"]
plotdata[Parameter %in% c("Wholesale Biogas Price", "Wholesale Pt-LNG Price", "Wholesale LNG Price", "Wholesale LNG Price (Mix)"), Parameter := "Wholesale Price"]
plotdata[Parameter %in% c("CO2 Tax Biogas", "CO2 Tax Pt-LNG", "CO2 Tax LNG", "CO2 Tax LNG Mix"), Parameter := "CO2 Tax"]
plotdata[Parameter %in% c("Excise Duty - biogas", "Excise Duty - Pt-LNG", "Excise Duty - LNG", "Excise Duty - LNG Mix"), Parameter := "Excise Duty"]
plotdata <- plotdata[, Parameter := factor(Parameter, levels = c( "Total Mark-Up", "CO2 Tax", "Excise Duty", "Wholesale Price"))]
plotdata[, `Type` := factor(`Type`, levels = c("Fossil LNG", "Bio Gas", "PT LNG", "LNG Mix"))]
plotdata[period == 2020 & Type == "PT LNG", value := 0]

p <- ggplot(plotdata[Country %in% Countries_plotted & period %in% yrs], aes(fill=Parameter, y=value, x=`Type`)) + theme(panel.grid.major=element_line(colour='#adadad'), panel.grid.minor=element_line(colour='#adadad')) +
    geom_bar(position="stack", stat="identity")+
      facet_wrap(`Fuel-Scenario` ~ period, nrow = 1, scales = "free")+
      facet_grid(`Fuel-Scenario` ~ period) + theme_bw()+
      theme(text = element_text(size = textSize))+
      scale_x_discrete(labels=function(x){sub("\\s", "\n", x)}) +
      labs(y = paste0("LNG Prices [EUR/kWh]")) + #, title = "Diesel Mix Prices") +
      scale_fill_manual(values=colorbarDie)
plot(p)

```

## Comparison plots LNG: Fossil vs Bio vs Syn vs Mix [EUR/kg]
```{r , include=TRUE, fig.width = 30,fig.height = 10}
yrs <- c(2020, 2030, 2035, 2040)
LNG_kWh_pro_kg <- 12.53

plotdata <- rbind(BioLNG,PtLNG, LNG, LNG_Mix)
plotdata[, value := value*LNG_kWh_pro_kg][, unit := "EUR/kg"]
plotdata[Parameter %in% c("Total NG Mark-Up"), Parameter := "Total Mark-Up"]
plotdata[Parameter %in% c("Wholesale Biogas Price", "Wholesale Pt-LNG Price", "Wholesale LNG Price", "Wholesale LNG Price (Mix)"), Parameter := "Wholesale Price"]
plotdata[Parameter %in% c("CO2 Tax Biogas", "CO2 Tax Pt-LNG", "CO2 Tax LNG", "CO2 Tax LNG Mix"), Parameter := "CO2 Tax"]
plotdata[Parameter %in% c("Excise Duty - biogas", "Excise Duty - Pt-LNG", "Excise Duty - LNG", "Excise Duty - LNG Mix"), Parameter := "Excise Duty"]
plotdata <- plotdata[, Parameter := factor(Parameter, levels = c( "Total Mark-Up", "CO2 Tax", "Excise Duty", "Wholesale Price"))]
plotdata[, `Type` := factor(`Type`, levels = c("Fossil LNG", "Bio Gas", "PT LNG", "LNG Mix"))]
plotdata[period == 2020 & Type == "PT LNG", value := 0]

p <- ggplot(plotdata[Country %in% Countries_plotted & period %in% yrs], aes(fill=Parameter, y=value, x=`Type`)) + theme(panel.grid.major=element_line(colour='#adadad'), panel.grid.minor=element_line(colour='#adadad')) +
    geom_bar(position="stack", stat="identity")+
      facet_wrap(`Fuel-Scenario` ~ period, nrow = 1, scales = "free")+
      facet_grid(`Fuel-Scenario` ~ period) + theme_bw()+
      theme(text = element_text(size = textSize))+
      scale_x_discrete(labels=function(x){sub("\\s", "\n", x)}) +
      labs(y = paste0("LNG Prices [EUR/kg]")) + #, title = "Diesel Mix Prices") +
      scale_fill_manual(values=colorbarDie)
plot(p)

```

# France
## Hydrogen Enduse Prices [EUR/kWh]
```{r , include=TRUE, fig.width = 30,fig.height = 10}
Countries_plotted <- c("FR")
yrs <- c(2030, 2040, 2050)
```

```{r , include=TRUE, fig.width = 30,fig.height = 10}
p <- ggplot(Hydrogen[Country %in% Countries_plotted & period %in% yrs], aes(fill=Parameter, y=value, x=`period`)) + theme(panel.grid.major=element_line(colour='#adadad'), panel.grid.minor=element_line(colour='#adadad')) +
    geom_bar(position="stack", stat="identity")+
      facet_grid(~ `Fuel-Scenario`, scales = "free")+
      theme(text = element_text(size = textSize))+
      labs(y = paste0("Hydrogen Price [EUR/kWh]")) + #, title = "Hydrogen Prices for different Fuel Scenarios") +
      scale_x_continuous(breaks = c(2030, 2040, 2050)) +
      scale_fill_manual(values=colorbarHydrogen)
plot(p)

```

## Hydrogen Enduse Prices [EUR/kg]
```{r , include=TRUE, fig.width = 30,fig.height = 10}
HydrogenKg <- copy(Hydrogen)
HydrogenKg[, `kWh/kg H2` := 33.33]
HydrogenKg[, value := value*`kWh/kg H2`][, unit := "EUR/kg"]

p <- ggplot(HydrogenKg[Country %in% Countries_plotted & period %in% yrs], aes(fill=Parameter, y=value, x=`period`)) + theme(panel.grid.major=element_line(colour='#adadad'), panel.grid.minor=element_line(colour='#adadad')) +
    geom_bar(position="stack", stat="identity")+
      facet_grid(~ `Fuel-Scenario`, scales = "free")+
      theme(text = element_text(size = textSize))+
      labs(y = paste0("Hydrogen Price [EUR/kg]")) + #, title = "Hydrogen Prices for different Fuel Scenarios") +
      scale_x_continuous(breaks = c(2030, 2040, 2050)) +
      scale_fill_manual(values=colorbarHydrogen)
plot(p)

```

## Electricity Enduse Prices Depot Charging [EUR/kWh]
```{r , include=TRUE, fig.width = 30,fig.height = 10}
p <- ggplot(Electricity_Depot[Country %in% Countries_plotted & period %in% yrs], aes(fill=Parameter, y=value, x=`period`)) + theme(panel.grid.major=element_line(colour='#adadad'), panel.grid.minor=element_line(colour='#adadad')) +
    geom_bar(position="stack", stat="identity")+
      facet_grid(~ `Fuel-Scenario`, scales = "free")+
      theme(text = element_text(size = textSize))+
      labs(y = paste0("Enduse Electricity Price [EUR/kWh]")) + #, title = "Electricity Prices Depot Charging") +
      scale_x_continuous(breaks = c(2030, 2040, 2050)) +
      scale_fill_manual(values=colorbarElec_CCS)
plot(p)

```

## Electricity Enduse Prices MCS Charging [EUR/kWh]
```{r , include=TRUE, fig.width = 30,fig.height = 10}
p <- ggplot(Electricity_MCS[Country %in% Countries_plotted & period %in% yrs], aes(fill=Parameter, y=value, x=`period`)) + theme(panel.grid.major=element_line(colour='#adadad'), panel.grid.minor=element_line(colour='#adadad')) +
    geom_bar(position="stack", stat="identity")+
      facet_grid(~ `Fuel-Scenario`, scales = "free")+
      theme(text = element_text(size = textSize))+
      labs(y = paste0("Enduse Electricity Price [EUR/kWh]")) + #, title = "Electricity Prices MCS Charging") +
      scale_x_continuous(breaks = c(2030, 2040, 2050)) +
      scale_fill_manual(values=colorbarElec_MCS)
plot(p)

```

## Diesel Mix Enduse Prices [EUR/kWh]
```{r , include=TRUE, fig.width = 30,fig.height = 10}
p <- ggplot(Diesel_Mix[Country %in% Countries_plotted & period %in% yrs], aes(fill=Parameter, y=value, x=`period`)) + theme(panel.grid.major=element_line(colour='#adadad'), panel.grid.minor=element_line(colour='#adadad')) +
    geom_bar(position="stack", stat="identity")+
      facet_grid(~ `Fuel-Scenario`, scales = "free")+
      theme(text = element_text(size = textSize))+
      labs(y = paste0("Enduse Diesel Mix Price [EUR/kWh]")) + #, title = "Diesel Mix Prices") +
      scale_x_continuous(breaks = c(2030, 2040, 2050)) +
      scale_fill_manual(values=colorbarDie)
plot(p)

```

## Fossil Diesel Enduse Prices [EUR/kWh]
```{r , include=TRUE, fig.width = 30,fig.height = 10}
p <- ggplot(Diesel[Country %in% Countries_plotted & period %in% yrs], aes(fill=Parameter, y=value, x=`period`)) + theme(panel.grid.major=element_line(colour='#adadad'), panel.grid.minor=element_line(colour='#adadad')) +
    geom_bar(position="stack", stat="identity")+
      facet_grid(~ `Fuel-Scenario`, scales = "free")+
      theme(text = element_text(size = textSize))+
      labs(y = paste0("Enduse Fossil Diesel Price [EUR/kWh]")) + #, title = "Diesel Mix Prices") +
      scale_x_continuous(breaks = c(2030, 2040, 2050)) +
      scale_fill_manual(values=colorbarDie)
plot(p)

```

## Pt-Diesel Enduse Prices [EUR/kWh]
```{r , include=TRUE, fig.width = 30,fig.height = 10}
p <- ggplot(PtDiesel[Country %in% Countries_plotted & period %in% yrs], aes(fill=Parameter, y=value, x=`period`)) + theme(panel.grid.major=element_line(colour='#adadad'), panel.grid.minor=element_line(colour='#adadad')) +
    geom_bar(position="stack", stat="identity")+
      facet_grid(~ `Fuel-Scenario`, scales = "free")+
      theme(text = element_text(size = textSize))+
      labs(y = paste0("Enduse Pt-Diesel Price [EUR/kWh]")) + #, title = "Diesel Mix Prices") +
      scale_x_continuous(breaks = c(2030, 2040, 2050)) +
      scale_fill_manual(values=colorbarDie)
plot(p)

```

## Biodiesel Enduse Prices [EUR/kWh]
```{r , include=TRUE, fig.width = 30,fig.height = 10}
p <- ggplot(BioDiesel[Country %in% Countries_plotted & period %in% yrs], aes(fill=Parameter, y=value, x=`period`)) + theme(panel.grid.major=element_line(colour='#adadad'), panel.grid.minor=element_line(colour='#adadad')) +
    geom_bar(position="stack", stat="identity")+
      facet_grid(~ `Fuel-Scenario`, scales = "free")+
      theme(text = element_text(size = textSize))+
      labs(y = paste0("Enduse Biodiesel Price [EUR/kWh]")) + #, title = "Diesel Mix Prices") +
      scale_x_continuous(breaks = c(2030, 2040, 2050)) +
      scale_fill_manual(values=colorbarDie)
plot(p)

```

## LNG Mix Enduse Prices [EUR/kWh]
```{r , include=TRUE, fig.width = 30,fig.height = 10}
p <- ggplot(LNG_Mix[Country %in% Countries_plotted & period %in% yrs], aes(fill=Parameter, y=value, x=`period`)) + theme(panel.grid.major=element_line(colour='#adadad'), panel.grid.minor=element_line(colour='#adadad')) +
    geom_bar(position="stack", stat="identity")+
      facet_grid(~ `Fuel-Scenario`, scales = "free")+
      theme(text = element_text(size = textSize))+
      labs(y = paste0("Enduse LNG Mix Price [EUR/kWh]")) + #, title = "LNG Mix Prices") +
      scale_x_continuous(breaks = c(2030, 2040, 2050)) +
      scale_fill_manual(values=colorbarLNG)
plot(p)
```

## Fossil LNG Enduse Prices [EUR/kWh]
```{r , include=TRUE, fig.width = 30,fig.height = 10}
p <- ggplot(LNG[Country %in% Countries_plotted & period %in% yrs], aes(fill=Parameter, y=value, x=`period`)) + theme(panel.grid.major=element_line(colour='#adadad'), panel.grid.minor=element_line(colour='#adadad')) +
    geom_bar(position="stack", stat="identity")+
      facet_grid(~ `Fuel-Scenario`, scales = "free")+
      theme(text = element_text(size = textSize))+
      labs(y = paste0("Enduse Fossil LNG Price [EUR/kWh]")) + #, title = "Diesel Mix Prices") +
      scale_x_continuous(breaks = c(2030, 2040, 2050)) +
      scale_fill_manual(values=colorbarDie)
plot(p)

```

## Pt-LNG Enduse Prices [EUR/kWh]
```{r , include=TRUE, fig.width = 30,fig.height = 10}
p <- ggplot(PtLNG[Country %in% Countries_plotted & period %in% yrs], aes(fill=Parameter, y=value, x=`period`)) + theme(panel.grid.major=element_line(colour='#adadad'), panel.grid.minor=element_line(colour='#adadad')) +
    geom_bar(position="stack", stat="identity")+
      facet_grid(~ `Fuel-Scenario`, scales = "free")+
      theme(text = element_text(size = textSize))+
      labs(y = paste0("Enduse Pt-LNG Price [EUR/kWh]")) + #, title = "Diesel Mix Prices") +
      scale_x_continuous(breaks = c(2030, 2040, 2050)) +
      scale_fill_manual(values=colorbarDie)
plot(p)

```

## Biogas Enduse Prices [EUR/kWh]
```{r , include=TRUE, fig.width = 30,fig.height = 10}
p <- ggplot(BioLNG[Country %in% Countries_plotted & period %in% yrs], aes(fill=Parameter, y=value, x=`period`)) + theme(panel.grid.major=element_line(colour='#adadad'), panel.grid.minor=element_line(colour='#adadad')) +
    geom_bar(position="stack", stat="identity")+
      facet_grid(~ `Fuel-Scenario`, scales = "free")+
      theme(text = element_text(size = textSize))+
      labs(y = paste0("Enduse Biogas Price [EUR/kWh]")) + #, title = "Diesel Mix Prices") +
      scale_x_continuous(breaks = c(2030, 2040, 2050)) +
      scale_fill_manual(values=colorbarDie)
plot(p)

```

## Comparison plots Diesel: Fossil vs Bio vs Syn vs Mix [EUR/kWh]
```{r , include=TRUE, fig.width = 30,fig.height = 10}

yrs <- c(2020, 2030, 2035, 2040)
plotdata <- rbind(BioDiesel,PtDiesel, Diesel, Diesel_Mix)
plotdata[Parameter %in% c("Total Diesel Mark-Up"), Parameter := "Total Mark-Up"]
plotdata[Parameter %in% c("Wholesale Biodiesel Price", "Wholesale PT-Diesel Price", "Wholesale Diesel Price", "Wholesale Diesel Price (Mix)"), Parameter := "Wholesale Price"]
plotdata[Parameter %in% c("CO2 Tax Biodiesel", "CO2 Tax Pt-Diesel", "CO2 Tax Diesel", "CO2 Tax Diesel Mix"), Parameter := "CO2 Tax"]
plotdata[Parameter %in% c("Excise Duty - biodiesel", "Excise Duty - Synthetic Diesel (E-Fuels)", "Excise Duty - Diesel", "Excise Duty - Diesel Mix"), Parameter := "Excise Duty"]
plotdata <- plotdata[, Parameter := factor(Parameter, levels = c( "Total Mark-Up", "CO2 Tax", "Excise Duty", "Wholesale Price"))]
plotdata[, `Type` := factor(`Type`, levels = c("Fossil Diesel", "Bio Diesel", "PT Diesel", "Diesel Mix"))]
plotdata[period == 2020 & Type == "PT Diesel", value := 0]

p <- ggplot(plotdata[Country %in% Countries_plotted & period %in% yrs], aes(fill=Parameter, y=value, x=`Type`)) + theme(panel.grid.major=element_line(colour='#adadad'), panel.grid.minor=element_line(colour='#adadad')) +
    geom_bar(position="stack", stat="identity")+
      facet_wrap(`Fuel-Scenario` ~ period, nrow = 1, scales = "free")+
      facet_grid(`Fuel-Scenario` ~ period) + theme_bw()+
      theme(text = element_text(size = textSize))+
      scale_x_discrete(labels=function(x){sub("\\s", "\n", x)}) +
      labs(y = paste0("Diesel Prices [EUR/kWh]")) + #, title = "Diesel Mix Prices") +
      scale_fill_manual(values=colorbarDie)
plot(p)

```

## Comparison plots Diesel: Fossil vs Bio vs Syn vs Mix [EUR/l]
```{r , include=TRUE, fig.width = 30,fig.height = 10}
Diesel_kWh_pro_l <- 9.97
BioDiesel_kWh_pro_l <- 9.11

yrs <- c(2020, 2030, 2035, 2040)
plotdata <- rbind(BioDiesel,PtDiesel, Diesel, Diesel_Mix)
plotdata[, value := ifelse(Type== "Biodiesel", value*BioDiesel_kWh_pro_l, value*Diesel_kWh_pro_l)][, unit := "EUR/l"]
plotdata[Parameter %in% c("Total Diesel Mark-Up"), Parameter := "Total Mark-Up"]
plotdata[Parameter %in% c("Wholesale Biodiesel Price", "Wholesale PT-Diesel Price", "Wholesale Diesel Price", "Wholesale Diesel Price (Mix)"), Parameter := "Wholesale Price"]
plotdata[Parameter %in% c("CO2 Tax Biodiesel", "CO2 Tax Pt-Diesel", "CO2 Tax Diesel", "CO2 Tax Diesel Mix"), Parameter := "CO2 Tax"]
plotdata[Parameter %in% c("Excise Duty - biodiesel", "Excise Duty - Synthetic Diesel (E-Fuels)", "Excise Duty - Diesel", "Excise Duty - Diesel Mix"), Parameter := "Excise Duty"]
plotdata <- plotdata[, Parameter := factor(Parameter, levels = c( "Total Mark-Up", "CO2 Tax", "Excise Duty", "Wholesale Price"))]
plotdata[, `Type` := factor(`Type`, levels = c("Fossil Diesel", "Bio Diesel", "PT Diesel", "Diesel Mix"))]
#Set PT-Diesel Price to zero in 2020 because there is not quantity
plotdata[period == 2020 & Type == "PT Diesel", value := 0]

p <- ggplot(plotdata[Country %in% Countries_plotted & period %in% yrs], aes(fill=Parameter, y=value, x=`Type`)) + theme(panel.grid.major=element_line(colour='#adadad'), panel.grid.minor=element_line(colour='#adadad')) +
    geom_bar(position="stack", stat="identity")+
      facet_wrap(`Fuel-Scenario` ~ period, nrow = 1, scales = "free")+
      facet_grid(`Fuel-Scenario` ~ period) + theme_bw()+
      theme(text = element_text(size = textSize))+
      scale_x_discrete(labels=function(x){sub("\\s", "\n", x)}) +
      labs(y = paste0("Diesel Prices [EUR/l]")) + #, title = "Diesel Mix Prices") +
      scale_fill_manual(values=colorbarDie)
plot(p)

```

## Comparison plots LNG: Fossil vs Bio vs Syn vs Mix [EUR/kWh]
```{r , include=TRUE, fig.width = 30,fig.height = 10}

yrs <- c(2020, 2030, 2035, 2040)
plotdata <- rbind(BioLNG,PtLNG, LNG, LNG_Mix)
plotdata[Parameter %in% c("Total NG Mark-Up"), Parameter := "Total Mark-Up"]
plotdata[Parameter %in% c("Wholesale Biogas Price", "Wholesale Pt-LNG Price", "Wholesale LNG Price", "Wholesale LNG Price (Mix)"), Parameter := "Wholesale Price"]
plotdata[Parameter %in% c("CO2 Tax Biogas", "CO2 Tax Pt-LNG", "CO2 Tax LNG", "CO2 Tax LNG Mix"), Parameter := "CO2 Tax"]
plotdata[Parameter %in% c("Excise Duty - biogas", "Excise Duty - Pt-LNG", "Excise Duty - LNG", "Excise Duty - LNG Mix"), Parameter := "Excise Duty"]
plotdata <- plotdata[, Parameter := factor(Parameter, levels = c( "Total Mark-Up", "CO2 Tax", "Excise Duty", "Wholesale Price"))]
plotdata[, `Type` := factor(`Type`, levels = c("Fossil LNG", "Bio Gas", "PT LNG", "LNG Mix"))]
plotdata[period == 2020 & Type == "PT LNG", value := 0]

p <- ggplot(plotdata[Country %in% Countries_plotted & period %in% yrs], aes(fill=Parameter, y=value, x=`Type`)) + theme(panel.grid.major=element_line(colour='#adadad'), panel.grid.minor=element_line(colour='#adadad')) +
    geom_bar(position="stack", stat="identity")+
      facet_wrap(`Fuel-Scenario` ~ period, nrow = 1, scales = "free")+
      facet_grid(`Fuel-Scenario` ~ period) + theme_bw()+
      theme(text = element_text(size = textSize))+
      scale_x_discrete(labels=function(x){sub("\\s", "\n", x)}) +
      labs(y = paste0("LNG Prices [EUR/kWh]")) + #, title = "Diesel Mix Prices") +
      scale_fill_manual(values=colorbarDie)
plot(p)

```

## Comparison plots LNG: Fossil vs Bio vs Syn vs Mix [EUR/kg]
```{r , include=TRUE, fig.width = 30,fig.height = 10}
yrs <- c(2020, 2030, 2035, 2040)
LNG_kWh_pro_kg <- 12.53

plotdata <- rbind(BioLNG,PtLNG, LNG, LNG_Mix)
plotdata[, value := value*LNG_kWh_pro_kg][, unit := "EUR/kg"]
plotdata[Parameter %in% c("Total NG Mark-Up"), Parameter := "Total Mark-Up"]
plotdata[Parameter %in% c("Wholesale Biogas Price", "Wholesale Pt-LNG Price", "Wholesale LNG Price", "Wholesale LNG Price (Mix)"), Parameter := "Wholesale Price"]
plotdata[Parameter %in% c("CO2 Tax Biogas", "CO2 Tax Pt-LNG", "CO2 Tax LNG", "CO2 Tax LNG Mix"), Parameter := "CO2 Tax"]
plotdata[Parameter %in% c("Excise Duty - biogas", "Excise Duty - Pt-LNG", "Excise Duty - LNG", "Excise Duty - LNG Mix"), Parameter := "Excise Duty"]
plotdata <- plotdata[, Parameter := factor(Parameter, levels = c( "Total Mark-Up", "CO2 Tax", "Excise Duty", "Wholesale Price"))]
plotdata[, `Type` := factor(`Type`, levels = c("Fossil LNG", "Bio Gas", "PT LNG", "LNG Mix"))]
plotdata[period == 2020 & Type == "PT LNG", value := 0]

p <- ggplot(plotdata[Country %in% Countries_plotted & period %in% yrs], aes(fill=Parameter, y=value, x=`Type`)) + theme(panel.grid.major=element_line(colour='#adadad'), panel.grid.minor=element_line(colour='#adadad')) +
    geom_bar(position="stack", stat="identity")+
      facet_wrap(`Fuel-Scenario` ~ period, nrow = 1, scales = "free")+
      facet_grid(`Fuel-Scenario` ~ period) + theme_bw()+
      theme(text = element_text(size = textSize))+
      scale_x_discrete(labels=function(x){sub("\\s", "\n", x)}) +
      labs(y = paste0("LNG Prices [EUR/kg]")) + #, title = "Diesel Mix Prices") +
      scale_fill_manual(values=colorbarDie)
plot(p)

```

# Spain
## Hydrogen Enduse Prices [EUR/kWh]
```{r , include=TRUE, fig.width = 30,fig.height = 10}
Countries_plotted <- c("ES")
yrs <- c(2030, 2040, 2050)
```

```{r , include=TRUE, fig.width = 30,fig.height = 10}
p <- ggplot(Hydrogen[Country %in% Countries_plotted & period %in% yrs], aes(fill=Parameter, y=value, x=`period`)) + theme(panel.grid.major=element_line(colour='#adadad'), panel.grid.minor=element_line(colour='#adadad')) +
    geom_bar(position="stack", stat="identity")+
      facet_grid(~ `Fuel-Scenario`, scales = "free")+
      theme(text = element_text(size = textSize))+
      labs(y = paste0("Hydrogen Price [EUR/kWh]")) + #, title = "Hydrogen Prices for different Fuel Scenarios") +
      scale_x_continuous(breaks = c(2030, 2040, 2050)) +
      scale_fill_manual(values=colorbarHydrogen)
plot(p)

```

## Hydrogen Enduse Prices [EUR/kg]
```{r , include=TRUE, fig.width = 30,fig.height = 10}
HydrogenKg <- copy(Hydrogen)
HydrogenKg[, `kWh/kg H2` := 33.33]
HydrogenKg[, value := value*`kWh/kg H2`][, unit := "EUR/kg"]

p <- ggplot(HydrogenKg[Country %in% Countries_plotted & period %in% yrs], aes(fill=Parameter, y=value, x=`period`)) + theme(panel.grid.major=element_line(colour='#adadad'), panel.grid.minor=element_line(colour='#adadad')) +
    geom_bar(position="stack", stat="identity")+
      facet_grid(~ `Fuel-Scenario`, scales = "free")+
      theme(text = element_text(size = textSize))+
      labs(y = paste0("Hydrogen Price [EUR/kg]")) + #, title = "Hydrogen Prices for different Fuel Scenarios") +
      scale_x_continuous(breaks = c(2030, 2040, 2050)) +
      scale_fill_manual(values=colorbarHydrogen)
plot(p)

```

## Electricity Enduse Prices Depot Charging [EUR/kWh]
```{r , include=TRUE, fig.width = 30,fig.height = 10}
p <- ggplot(Electricity_Depot[Country %in% Countries_plotted & period %in% yrs], aes(fill=Parameter, y=value, x=`period`)) + theme(panel.grid.major=element_line(colour='#adadad'), panel.grid.minor=element_line(colour='#adadad')) +
    geom_bar(position="stack", stat="identity")+
      facet_grid(~ `Fuel-Scenario`, scales = "free")+
      theme(text = element_text(size = textSize))+
      labs(y = paste0("Enduse Electricity Price [EUR/kWh]")) + #, title = "Electricity Prices Depot Charging") +
      scale_x_continuous(breaks = c(2030, 2040, 2050)) +
      scale_fill_manual(values=colorbarElec_CCS)
plot(p)

```

## Electricity Enduse Prices MCS Charging [EUR/kWh]
```{r , include=TRUE, fig.width = 30,fig.height = 10}
p <- ggplot(Electricity_MCS[Country %in% Countries_plotted & period %in% yrs], aes(fill=Parameter, y=value, x=`period`)) + theme(panel.grid.major=element_line(colour='#adadad'), panel.grid.minor=element_line(colour='#adadad')) +
    geom_bar(position="stack", stat="identity")+
      facet_grid(~ `Fuel-Scenario`, scales = "free")+
      theme(text = element_text(size = textSize))+
      labs(y = paste0("Enduse Electricity Price [EUR/kWh]")) + #, title = "Electricity Prices MCS Charging") +
      scale_x_continuous(breaks = c(2030, 2040, 2050)) +
      scale_fill_manual(values=colorbarElec_MCS)
plot(p)

```

## Diesel Mix Enduse Prices [EUR/kWh]
```{r , include=TRUE, fig.width = 30,fig.height = 10}
p <- ggplot(Diesel_Mix[Country %in% Countries_plotted & period %in% yrs], aes(fill=Parameter, y=value, x=`period`)) + theme(panel.grid.major=element_line(colour='#adadad'), panel.grid.minor=element_line(colour='#adadad')) +
    geom_bar(position="stack", stat="identity")+
      facet_grid(~ `Fuel-Scenario`, scales = "free")+
      theme(text = element_text(size = textSize))+
      labs(y = paste0("Enduse Diesel Mix Price [EUR/kWh]")) + #, title = "Diesel Mix Prices") +
      scale_x_continuous(breaks = c(2030, 2040, 2050)) +
      scale_fill_manual(values=colorbarDie)
plot(p)

```

## Fossil Diesel Enduse Prices [EUR/kWh]
```{r , include=TRUE, fig.width = 30,fig.height = 10}
p <- ggplot(Diesel[Country %in% Countries_plotted & period %in% yrs], aes(fill=Parameter, y=value, x=`period`)) + theme(panel.grid.major=element_line(colour='#adadad'), panel.grid.minor=element_line(colour='#adadad')) +
    geom_bar(position="stack", stat="identity")+
      facet_grid(~ `Fuel-Scenario`, scales = "free")+
      theme(text = element_text(size = textSize))+
      labs(y = paste0("Enduse Fossil Diesel Price [EUR/kWh]")) + #, title = "Diesel Mix Prices") +
      scale_x_continuous(breaks = c(2030, 2040, 2050)) +
      scale_fill_manual(values=colorbarDie)
plot(p)

```

## Pt-Diesel Enduse Prices [EUR/kWh]
```{r , include=TRUE, fig.width = 30,fig.height = 10}
p <- ggplot(PtDiesel[Country %in% Countries_plotted & period %in% yrs], aes(fill=Parameter, y=value, x=`period`)) + theme(panel.grid.major=element_line(colour='#adadad'), panel.grid.minor=element_line(colour='#adadad')) +
    geom_bar(position="stack", stat="identity")+
      facet_grid(~ `Fuel-Scenario`, scales = "free")+
      theme(text = element_text(size = textSize))+
      labs(y = paste0("Enduse Pt-Diesel Price [EUR/kWh]")) + #, title = "Diesel Mix Prices") +
      scale_x_continuous(breaks = c(2030, 2040, 2050)) +
      scale_fill_manual(values=colorbarDie)
plot(p)

```

## Biodiesel Enduse Prices [EUR/kWh]
```{r , include=TRUE, fig.width = 30,fig.height = 10}
p <- ggplot(BioDiesel[Country %in% Countries_plotted & period %in% yrs], aes(fill=Parameter, y=value, x=`period`)) + theme(panel.grid.major=element_line(colour='#adadad'), panel.grid.minor=element_line(colour='#adadad')) +
    geom_bar(position="stack", stat="identity")+
      facet_grid(~ `Fuel-Scenario`, scales = "free")+
      theme(text = element_text(size = textSize))+
      labs(y = paste0("Enduse Biodiesel Price [EUR/kWh]")) + #, title = "Diesel Mix Prices") +
      scale_x_continuous(breaks = c(2030, 2040, 2050)) +
      scale_fill_manual(values=colorbarDie)
plot(p)

```

## LNG Mix Enduse Prices [EUR/kWh]
```{r , include=TRUE, fig.width = 30,fig.height = 10}
p <- ggplot(LNG_Mix[Country %in% Countries_plotted & period %in% yrs], aes(fill=Parameter, y=value, x=`period`)) + theme(panel.grid.major=element_line(colour='#adadad'), panel.grid.minor=element_line(colour='#adadad')) +
    geom_bar(position="stack", stat="identity")+
      facet_grid(~ `Fuel-Scenario`, scales = "free")+
      theme(text = element_text(size = textSize))+
      labs(y = paste0("Enduse LNG Mix Price [EUR/kWh]")) + #, title = "LNG Mix Prices") +
      scale_x_continuous(breaks = c(2030, 2040, 2050)) +
      scale_fill_manual(values=colorbarLNG)
plot(p)
```

## Fossil LNG Enduse Prices [EUR/kWh]
```{r , include=TRUE, fig.width = 30,fig.height = 10}
p <- ggplot(LNG[Country %in% Countries_plotted & period %in% yrs], aes(fill=Parameter, y=value, x=`period`)) + theme(panel.grid.major=element_line(colour='#adadad'), panel.grid.minor=element_line(colour='#adadad')) +
    geom_bar(position="stack", stat="identity")+
      facet_grid(~ `Fuel-Scenario`, scales = "free")+
      theme(text = element_text(size = textSize))+
      labs(y = paste0("Enduse Fossil LNG Price [EUR/kWh]")) + #, title = "Diesel Mix Prices") +
      scale_x_continuous(breaks = c(2030, 2040, 2050)) +
      scale_fill_manual(values=colorbarDie)
plot(p)

```

## Pt-LNG Enduse Prices [EUR/kWh]
```{r , include=TRUE, fig.width = 30,fig.height = 10}
p <- ggplot(PtLNG[Country %in% Countries_plotted & period %in% yrs], aes(fill=Parameter, y=value, x=`period`)) + theme(panel.grid.major=element_line(colour='#adadad'), panel.grid.minor=element_line(colour='#adadad')) +
    geom_bar(position="stack", stat="identity")+
      facet_grid(~ `Fuel-Scenario`, scales = "free")+
      theme(text = element_text(size = textSize))+
      labs(y = paste0("Enduse Pt-LNG Price [EUR/kWh]")) + #, title = "Diesel Mix Prices") +
      scale_x_continuous(breaks = c(2030, 2040, 2050)) +
      scale_fill_manual(values=colorbarDie)
plot(p)

```

## Biogas Enduse Prices [EUR/kWh]
```{r , include=TRUE, fig.width = 30,fig.height = 10}
p <- ggplot(BioLNG[Country %in% Countries_plotted & period %in% yrs], aes(fill=Parameter, y=value, x=`period`)) + theme(panel.grid.major=element_line(colour='#adadad'), panel.grid.minor=element_line(colour='#adadad')) +
    geom_bar(position="stack", stat="identity")+
      facet_grid(~ `Fuel-Scenario`, scales = "free")+
      theme(text = element_text(size = textSize))+
      labs(y = paste0("Enduse Biogas Price [EUR/kWh]")) + #, title = "Diesel Mix Prices") +
      scale_x_continuous(breaks = c(2030, 2040, 2050)) +
      scale_fill_manual(values=colorbarDie)
plot(p)

```

## Comparison plots Diesel: Fossil vs Bio vs Syn vs Mix [EUR/kWh]
```{r , include=TRUE, fig.width = 30,fig.height = 10}

yrs <- c(2020, 2030, 2035, 2040)
plotdata <- rbind(BioDiesel,PtDiesel, Diesel, Diesel_Mix)
plotdata[Parameter %in% c("Total Diesel Mark-Up"), Parameter := "Total Mark-Up"]
plotdata[Parameter %in% c("Wholesale Biodiesel Price", "Wholesale PT-Diesel Price", "Wholesale Diesel Price", "Wholesale Diesel Price (Mix)"), Parameter := "Wholesale Price"]
plotdata[Parameter %in% c("CO2 Tax Biodiesel", "CO2 Tax Pt-Diesel", "CO2 Tax Diesel", "CO2 Tax Diesel Mix"), Parameter := "CO2 Tax"]
plotdata[Parameter %in% c("Excise Duty - biodiesel", "Excise Duty - Synthetic Diesel (E-Fuels)", "Excise Duty - Diesel", "Excise Duty - Diesel Mix"), Parameter := "Excise Duty"]
plotdata <- plotdata[, Parameter := factor(Parameter, levels = c( "Total Mark-Up", "CO2 Tax", "Excise Duty", "Wholesale Price"))]
plotdata[, `Type` := factor(`Type`, levels = c("Fossil Diesel", "Bio Diesel", "PT Diesel", "Diesel Mix"))]
plotdata[period == 2020 & Type == "PT Diesel", value := 0]

p <- ggplot(plotdata[Country %in% Countries_plotted & period %in% yrs], aes(fill=Parameter, y=value, x=`Type`)) + theme(panel.grid.major=element_line(colour='#adadad'), panel.grid.minor=element_line(colour='#adadad')) +
    geom_bar(position="stack", stat="identity")+
      facet_wrap(`Fuel-Scenario` ~ period, nrow = 1, scales = "free")+
      facet_grid(`Fuel-Scenario` ~ period) + theme_bw()+
      theme(text = element_text(size = textSize))+
      scale_x_discrete(labels=function(x){sub("\\s", "\n", x)}) +
      labs(y = paste0("Diesel Prices [EUR/kWh]")) + #, title = "Diesel Mix Prices") +
      scale_fill_manual(values=colorbarDie)
plot(p)

```

## Comparison plots Diesel: Fossil vs Bio vs Syn vs Mix [EUR/l]
```{r , include=TRUE, fig.width = 30,fig.height = 10}
Diesel_kWh_pro_l <- 9.97
BioDiesel_kWh_pro_l <- 9.11

yrs <- c(2020, 2030, 2035, 2040)
plotdata <- rbind(BioDiesel,PtDiesel, Diesel, Diesel_Mix)
plotdata[, value := ifelse(Type== "Biodiesel", value*BioDiesel_kWh_pro_l, value*Diesel_kWh_pro_l)][, unit := "EUR/l"]
plotdata[Parameter %in% c("Total Diesel Mark-Up"), Parameter := "Total Mark-Up"]
plotdata[Parameter %in% c("Wholesale Biodiesel Price", "Wholesale PT-Diesel Price", "Wholesale Diesel Price", "Wholesale Diesel Price (Mix)"), Parameter := "Wholesale Price"]
plotdata[Parameter %in% c("CO2 Tax Biodiesel", "CO2 Tax Pt-Diesel", "CO2 Tax Diesel", "CO2 Tax Diesel Mix"), Parameter := "CO2 Tax"]
plotdata[Parameter %in% c("Excise Duty - biodiesel", "Excise Duty - Synthetic Diesel (E-Fuels)", "Excise Duty - Diesel", "Excise Duty - Diesel Mix"), Parameter := "Excise Duty"]
plotdata <- plotdata[, Parameter := factor(Parameter, levels = c( "Total Mark-Up", "CO2 Tax", "Excise Duty", "Wholesale Price"))]
plotdata[, `Type` := factor(`Type`, levels = c("Fossil Diesel", "Bio Diesel", "PT Diesel", "Diesel Mix"))]
#Set PT-Diesel Price to zero in 2020 because there is not quantity
plotdata[period == 2020 & Type == "PT Diesel", value := 0]

p <- ggplot(plotdata[Country %in% Countries_plotted & period %in% yrs], aes(fill=Parameter, y=value, x=`Type`)) + theme(panel.grid.major=element_line(colour='#adadad'), panel.grid.minor=element_line(colour='#adadad')) +
    geom_bar(position="stack", stat="identity")+
      facet_wrap(`Fuel-Scenario` ~ period, nrow = 1, scales = "free")+
      facet_grid(`Fuel-Scenario` ~ period) + theme_bw()+
      theme(text = element_text(size = textSize))+
      scale_x_discrete(labels=function(x){sub("\\s", "\n", x)}) +
      labs(y = paste0("Diesel Prices [EUR/l]")) + #, title = "Diesel Mix Prices") +
      scale_fill_manual(values=colorbarDie)
plot(p)

```

## Comparison plots LNG: Fossil vs Bio vs Syn vs Mix [EUR/kWh]
```{r , include=TRUE, fig.width = 30,fig.height = 10}

yrs <- c(2020, 2030, 2035, 2040)
plotdata <- rbind(BioLNG,PtLNG, LNG, LNG_Mix)
plotdata[Parameter %in% c("Total NG Mark-Up"), Parameter := "Total Mark-Up"]
plotdata[Parameter %in% c("Wholesale Biogas Price", "Wholesale Pt-LNG Price", "Wholesale LNG Price", "Wholesale LNG Price (Mix)"), Parameter := "Wholesale Price"]
plotdata[Parameter %in% c("CO2 Tax Biogas", "CO2 Tax Pt-LNG", "CO2 Tax LNG", "CO2 Tax LNG Mix"), Parameter := "CO2 Tax"]
plotdata[Parameter %in% c("Excise Duty - biogas", "Excise Duty - Pt-LNG", "Excise Duty - LNG", "Excise Duty - LNG Mix"), Parameter := "Excise Duty"]
plotdata <- plotdata[, Parameter := factor(Parameter, levels = c( "Total Mark-Up", "CO2 Tax", "Excise Duty", "Wholesale Price"))]
plotdata[, `Type` := factor(`Type`, levels = c("Fossil LNG", "Bio Gas", "PT LNG", "LNG Mix"))]
plotdata[period == 2020 & Type == "PT LNG", value := 0]

p <- ggplot(plotdata[Country %in% Countries_plotted & period %in% yrs], aes(fill=Parameter, y=value, x=`Type`)) + theme(panel.grid.major=element_line(colour='#adadad'), panel.grid.minor=element_line(colour='#adadad')) +
    geom_bar(position="stack", stat="identity")+
      facet_wrap(`Fuel-Scenario` ~ period, nrow = 1, scales = "free")+
      facet_grid(`Fuel-Scenario` ~ period) + theme_bw()+
      theme(text = element_text(size = textSize))+
      scale_x_discrete(labels=function(x){sub("\\s", "\n", x)}) +
      labs(y = paste0("Diesel Prices [EUR/kWh]")) + #, title = "Diesel Mix Prices") +
      scale_fill_manual(values=colorbarDie)
plot(p)

```

## Comparison plots LNG: Fossil vs Bio vs Syn vs Mix [EUR/kg]
```{r , include=TRUE, fig.width = 30,fig.height = 10}
yrs <- c(2020, 2030, 2035, 2040)
LNG_kWh_pro_kg <- 12.53

plotdata <- rbind(BioLNG,PtLNG, LNG, LNG_Mix)
plotdata[, value := value*LNG_kWh_pro_kg][, unit := "EUR/kg"]
plotdata[Parameter %in% c("Total NG Mark-Up"), Parameter := "Total Mark-Up"]
plotdata[Parameter %in% c("Wholesale Biogas Price", "Wholesale Pt-LNG Price", "Wholesale LNG Price", "Wholesale LNG Price (Mix)"), Parameter := "Wholesale Price"]
plotdata[Parameter %in% c("CO2 Tax Biogas", "CO2 Tax Pt-LNG", "CO2 Tax LNG", "CO2 Tax LNG Mix"), Parameter := "CO2 Tax"]
plotdata[Parameter %in% c("Excise Duty - biogas", "Excise Duty - Pt-LNG", "Excise Duty - LNG", "Excise Duty - LNG Mix"), Parameter := "Excise Duty"]
plotdata <- plotdata[, Parameter := factor(Parameter, levels = c( "Total Mark-Up", "CO2 Tax", "Excise Duty", "Wholesale Price"))]
plotdata[, `Type` := factor(`Type`, levels = c("Fossil LNG", "Bio Gas", "PT LNG", "LNG Mix"))]
plotdata[period == 2020 & Type == "PT LNG", value := 0]

p <- ggplot(plotdata[Country %in% Countries_plotted & period %in% yrs], aes(fill=Parameter, y=value, x=`Type`)) + theme(panel.grid.major=element_line(colour='#adadad'), panel.grid.minor=element_line(colour='#adadad')) +
    geom_bar(position="stack", stat="identity")+
      facet_wrap(`Fuel-Scenario` ~ period, nrow = 1, scales = "free")+
      facet_grid(`Fuel-Scenario` ~ period) + theme_bw()+
      theme(text = element_text(size = textSize))+
      scale_x_discrete(labels=function(x){sub("\\s", "\n", x)}) +
      labs(y = paste0("LNG Prices [EUR/kg]")) + #, title = "Diesel Mix Prices") +
      scale_fill_manual(values=colorbarDie)
plot(p)

```

# United Kingdom
## Hydrogen Enduse Prices [EUR/kWh]
```{r , include=TRUE, fig.width = 30,fig.height = 10}
Countries_plotted <- c("UK")
yrs <- c(2030, 2040, 2050)
```

```{r , include=TRUE, fig.width = 30,fig.height = 10}
p <- ggplot(Hydrogen[Country %in% Countries_plotted & period %in% yrs], aes(fill=Parameter, y=value, x=`period`)) + theme(panel.grid.major=element_line(colour='#adadad'), panel.grid.minor=element_line(colour='#adadad')) +
    geom_bar(position="stack", stat="identity")+
      facet_grid(~ `Fuel-Scenario`, scales = "free")+
      theme(text = element_text(size = textSize))+
      labs(y = paste0("Hydrogen Price [EUR/kWh]")) + #, title = "Hydrogen Prices for different Fuel Scenarios") +
      scale_x_continuous(breaks = c(2030, 2040, 2050)) +
      scale_fill_manual(values=colorbarHydrogen)
plot(p)

```

## Hydrogen Enduse Prices [EUR/kg]
```{r , include=TRUE, fig.width = 30,fig.height = 10}
HydrogenKg <- copy(Hydrogen)
HydrogenKg[, `kWh/kg H2` := 33.33]
HydrogenKg[, value := value*`kWh/kg H2`][, unit := "EUR/kg"]

p <- ggplot(HydrogenKg[Country %in% Countries_plotted & period %in% yrs], aes(fill=Parameter, y=value, x=`period`)) + theme(panel.grid.major=element_line(colour='#adadad'), panel.grid.minor=element_line(colour='#adadad')) +
    geom_bar(position="stack", stat="identity")+
      facet_grid(~ `Fuel-Scenario`, scales = "free")+
      theme(text = element_text(size = textSize))+
      labs(y = paste0("Hydrogen Price [EUR/kg]")) + #, title = "Hydrogen Prices for different Fuel Scenarios") +
      scale_x_continuous(breaks = c(2030, 2040, 2050)) +
      scale_fill_manual(values=colorbarHydrogen)
plot(p)

```

## Electricity Enduse Prices Depot Charging [EUR/kWh]
```{r , include=TRUE, fig.width = 30,fig.height = 10}
p <- ggplot(Electricity_Depot[Country %in% Countries_plotted & period %in% yrs], aes(fill=Parameter, y=value, x=`period`)) + theme(panel.grid.major=element_line(colour='#adadad'), panel.grid.minor=element_line(colour='#adadad')) +
    geom_bar(position="stack", stat="identity")+
      facet_grid(~ `Fuel-Scenario`, scales = "free")+
      theme(text = element_text(size = textSize))+
      labs(y = paste0("Enduse Electricity Price [EUR/kWh]")) + #, title = "Electricity Prices Depot Charging") +
      scale_x_continuous(breaks = c(2030, 2040, 2050)) +
      scale_fill_manual(values=colorbarElec_CCS)
plot(p)

```

## Electricity Enduse Prices MCS Charging [EUR/kWh]
```{r , include=TRUE, fig.width = 30,fig.height = 10}
p <- ggplot(Electricity_MCS[Country %in% Countries_plotted & period %in% yrs], aes(fill=Parameter, y=value, x=`period`)) + theme(panel.grid.major=element_line(colour='#adadad'), panel.grid.minor=element_line(colour='#adadad')) +
    geom_bar(position="stack", stat="identity")+
      facet_grid(~ `Fuel-Scenario`, scales = "free")+
      theme(text = element_text(size = textSize))+
      labs(y = paste0("Enduse Electricity Price [EUR/kWh]")) + #, title = "Electricity Prices MCS Charging") +
      scale_x_continuous(breaks = c(2030, 2040, 2050)) +
      scale_fill_manual(values=colorbarElec_MCS)
plot(p)

```

## Diesel Mix Enduse Prices [EUR/kWh]
```{r , include=TRUE, fig.width = 30,fig.height = 10}
p <- ggplot(Diesel_Mix[Country %in% Countries_plotted & period %in% yrs], aes(fill=Parameter, y=value, x=`period`)) + theme(panel.grid.major=element_line(colour='#adadad'), panel.grid.minor=element_line(colour='#adadad')) +
    geom_bar(position="stack", stat="identity")+
      facet_grid(~ `Fuel-Scenario`, scales = "free")+
      theme(text = element_text(size = textSize))+
      labs(y = paste0("Enduse Diesel Mix Price [EUR/kWh]")) + #, title = "Diesel Mix Prices") +
      scale_x_continuous(breaks = c(2030, 2040, 2050)) +
      scale_fill_manual(values=colorbarDie)
plot(p)

```

## Fossil Diesel Enduse Prices [EUR/kWh]
```{r , include=TRUE, fig.width = 30,fig.height = 10}
p <- ggplot(Diesel[Country %in% Countries_plotted & period %in% yrs], aes(fill=Parameter, y=value, x=`period`)) + theme(panel.grid.major=element_line(colour='#adadad'), panel.grid.minor=element_line(colour='#adadad')) +
    geom_bar(position="stack", stat="identity")+
      facet_grid(~ `Fuel-Scenario`, scales = "free")+
      theme(text = element_text(size = textSize))+
      labs(y = paste0("Enduse Fossil Diesel Price [EUR/kWh]")) + #, title = "Diesel Mix Prices") +
      scale_x_continuous(breaks = c(2030, 2040, 2050)) +
      scale_fill_manual(values=colorbarDie)
plot(p)

```

## Pt-Diesel Enduse Prices [EUR/kWh]
```{r , include=TRUE, fig.width = 30,fig.height = 10}
p <- ggplot(PtDiesel[Country %in% Countries_plotted & period %in% yrs], aes(fill=Parameter, y=value, x=`period`)) + theme(panel.grid.major=element_line(colour='#adadad'), panel.grid.minor=element_line(colour='#adadad')) +
    geom_bar(position="stack", stat="identity")+
      facet_grid(~ `Fuel-Scenario`, scales = "free")+
      theme(text = element_text(size = textSize))+
      labs(y = paste0("Enduse Pt-Diesel Price [EUR/kWh]")) + #, title = "Diesel Mix Prices") +
      scale_x_continuous(breaks = c(2030, 2040, 2050)) +
      scale_fill_manual(values=colorbarDie)
plot(p)

```

## Biodiesel Enduse Prices [EUR/kWh]
```{r , include=TRUE, fig.width = 30,fig.height = 10}
p <- ggplot(BioDiesel[Country %in% Countries_plotted & period %in% yrs], aes(fill=Parameter, y=value, x=`period`)) + theme(panel.grid.major=element_line(colour='#adadad'), panel.grid.minor=element_line(colour='#adadad')) +
    geom_bar(position="stack", stat="identity")+
      facet_grid(~ `Fuel-Scenario`, scales = "free")+
      theme(text = element_text(size = textSize))+
      labs(y = paste0("Enduse Biodiesel Price [EUR/kWh]")) + #, title = "Diesel Mix Prices") +
      scale_x_continuous(breaks = c(2030, 2040, 2050)) +
      scale_fill_manual(values=colorbarDie)
plot(p)

```

## LNG Mix Enduse Prices [EUR/kWh]
```{r , include=TRUE, fig.width = 30,fig.height = 10}
p <- ggplot(LNG_Mix[Country %in% Countries_plotted & period %in% yrs], aes(fill=Parameter, y=value, x=`period`)) + theme(panel.grid.major=element_line(colour='#adadad'), panel.grid.minor=element_line(colour='#adadad')) +
    geom_bar(position="stack", stat="identity")+
      facet_grid(~ `Fuel-Scenario`, scales = "free")+
      theme(text = element_text(size = textSize))+
      labs(y = paste0("Enduse LNG Mix Price [EUR/kWh]")) + #, title = "LNG Mix Prices") +
      scale_x_continuous(breaks = c(2030, 2040, 2050)) +
      scale_fill_manual(values=colorbarLNG)
plot(p)
```

## Fossil LNG Enduse Prices [EUR/kWh]
```{r , include=TRUE, fig.width = 30,fig.height = 10}
p <- ggplot(LNG[Country %in% Countries_plotted & period %in% yrs], aes(fill=Parameter, y=value, x=`period`)) + theme(panel.grid.major=element_line(colour='#adadad'), panel.grid.minor=element_line(colour='#adadad')) +
    geom_bar(position="stack", stat="identity")+
      facet_grid(~ `Fuel-Scenario`, scales = "free")+
      theme(text = element_text(size = textSize))+
      labs(y = paste0("Enduse Fossil LNG Price [EUR/kWh]")) + #, title = "Diesel Mix Prices") +
      scale_x_continuous(breaks = c(2030, 2040, 2050)) +
      scale_fill_manual(values=colorbarDie)
plot(p)

```

## Pt-LNG Enduse Prices [EUR/kWh]
```{r , include=TRUE, fig.width = 30,fig.height = 10}
p <- ggplot(PtLNG[Country %in% Countries_plotted & period %in% yrs], aes(fill=Parameter, y=value, x=`period`)) + theme(panel.grid.major=element_line(colour='#adadad'), panel.grid.minor=element_line(colour='#adadad')) +
    geom_bar(position="stack", stat="identity")+
      facet_grid(~ `Fuel-Scenario`, scales = "free")+
      theme(text = element_text(size = textSize))+
      labs(y = paste0("Enduse Pt-LNG Price [EUR/kWh]")) + #, title = "Diesel Mix Prices") +
      scale_x_continuous(breaks = c(2030, 2040, 2050)) +
      scale_fill_manual(values=colorbarDie)
plot(p)

```

## Biogas Enduse Prices [EUR/kWh]
```{r , include=TRUE, fig.width = 30,fig.height = 10}
p <- ggplot(BioLNG[Country %in% Countries_plotted & period %in% yrs], aes(fill=Parameter, y=value, x=`period`)) + theme(panel.grid.major=element_line(colour='#adadad'), panel.grid.minor=element_line(colour='#adadad')) +
    geom_bar(position="stack", stat="identity")+
      facet_grid(~ `Fuel-Scenario`, scales = "free")+
      theme(text = element_text(size = textSize))+
      labs(y = paste0("Enduse Biogas Price [EUR/kWh]")) + #, title = "Diesel Mix Prices") +
      scale_x_continuous(breaks = c(2030, 2040, 2050)) +
      scale_fill_manual(values=colorbarDie)
plot(p)

```

## Comparison plots Diesel: Fossil vs Bio vs Syn vs Mix [EUR/kWh]
```{r , include=TRUE, fig.width = 30,fig.height = 10}

yrs <- c(2020, 2030, 2035, 2040)
plotdata <- rbind(BioDiesel,PtDiesel, Diesel, Diesel_Mix)
plotdata[Parameter %in% c("Total Diesel Mark-Up"), Parameter := "Total Mark-Up"]
plotdata[Parameter %in% c("Wholesale Biodiesel Price", "Wholesale PT-Diesel Price", "Wholesale Diesel Price", "Wholesale Diesel Price (Mix)"), Parameter := "Wholesale Price"]
plotdata[Parameter %in% c("CO2 Tax Biodiesel", "CO2 Tax Pt-Diesel", "CO2 Tax Diesel", "CO2 Tax Diesel Mix"), Parameter := "CO2 Tax"]
plotdata[Parameter %in% c("Excise Duty - biodiesel", "Excise Duty - Synthetic Diesel (E-Fuels)", "Excise Duty - Diesel", "Excise Duty - Diesel Mix"), Parameter := "Excise Duty"]
plotdata <- plotdata[, Parameter := factor(Parameter, levels = c( "Total Mark-Up", "CO2 Tax", "Excise Duty", "Wholesale Price"))]
plotdata[, `Type` := factor(`Type`, levels = c("Fossil Diesel", "Bio Diesel", "PT Diesel", "Diesel Mix"))]
plotdata[period == 2020 & Type == "PT Diesel", value := 0]

p <- ggplot(plotdata[Country %in% Countries_plotted & period %in% yrs], aes(fill=Parameter, y=value, x=`Type`)) + theme(panel.grid.major=element_line(colour='#adadad'), panel.grid.minor=element_line(colour='#adadad')) +
    geom_bar(position="stack", stat="identity")+
      facet_wrap(`Fuel-Scenario` ~ period, nrow = 1, scales = "free")+
      facet_grid(`Fuel-Scenario` ~ period) + theme_bw()+
      theme(text = element_text(size = textSize))+
      scale_x_discrete(labels=function(x){sub("\\s", "\n", x)}) +
      labs(y = paste0("Diesel Prices [EUR/kWh]")) + #, title = "Diesel Mix Prices") +
      scale_fill_manual(values=colorbarDie)
plot(p)

```

## Comparison plots Diesel: Fossil vs Bio vs Syn vs Mix [EUR/l]
```{r , include=TRUE, fig.width = 30,fig.height = 10}
Diesel_kWh_pro_l <- 9.97
BioDiesel_kWh_pro_l <- 9.11

yrs <- c(2020, 2030, 2035, 2040)
plotdata <- rbind(BioDiesel,PtDiesel, Diesel, Diesel_Mix)
plotdata[, value := ifelse(Type== "Biodiesel", value*BioDiesel_kWh_pro_l, value*Diesel_kWh_pro_l)][, unit := "EUR/l"]
plotdata[Parameter %in% c("Total Diesel Mark-Up"), Parameter := "Total Mark-Up"]
plotdata[Parameter %in% c("Wholesale Biodiesel Price", "Wholesale PT-Diesel Price", "Wholesale Diesel Price", "Wholesale Diesel Price (Mix)"), Parameter := "Wholesale Price"]
plotdata[Parameter %in% c("CO2 Tax Biodiesel", "CO2 Tax Pt-Diesel", "CO2 Tax Diesel", "CO2 Tax Diesel Mix"), Parameter := "CO2 Tax"]
plotdata[Parameter %in% c("Excise Duty - biodiesel", "Excise Duty - Synthetic Diesel (E-Fuels)", "Excise Duty - Diesel", "Excise Duty - Diesel Mix"), Parameter := "Excise Duty"]
plotdata <- plotdata[, Parameter := factor(Parameter, levels = c( "Total Mark-Up", "CO2 Tax", "Excise Duty", "Wholesale Price"))]
plotdata[, `Type` := factor(`Type`, levels = c("Fossil Diesel", "Bio Diesel", "PT Diesel", "Diesel Mix"))]
#Set PT-Diesel Price to zero in 2020 because there is not quantity
plotdata[period == 2020 & Type == "PT Diesel", value := 0]

p <- ggplot(plotdata[Country %in% Countries_plotted & period %in% yrs], aes(fill=Parameter, y=value, x=`Type`)) + theme(panel.grid.major=element_line(colour='#adadad'), panel.grid.minor=element_line(colour='#adadad')) +
    geom_bar(position="stack", stat="identity")+
      facet_wrap(`Fuel-Scenario` ~ period, nrow = 1, scales = "free")+
      facet_grid(`Fuel-Scenario` ~ period) + theme_bw()+
      theme(text = element_text(size = textSize))+
      scale_x_discrete(labels=function(x){sub("\\s", "\n", x)}) +
      labs(y = paste0("Diesel Prices [EUR/l]")) + #, title = "Diesel Mix Prices") +
      scale_fill_manual(values=colorbarDie)
plot(p)

```

## Comparison plots LNG: Fossil vs Bio vs Syn vs Mix [EUR/kWh]
```{r , include=TRUE, fig.width = 30,fig.height = 10}

yrs <- c(2020, 2030, 2035, 2040)
plotdata <- rbind(BioLNG,PtLNG, LNG, LNG_Mix)
plotdata[Parameter %in% c("Total NG Mark-Up"), Parameter := "Total Mark-Up"]
plotdata[Parameter %in% c("Wholesale Biogas Price", "Wholesale Pt-LNG Price", "Wholesale LNG Price", "Wholesale LNG Price (Mix)"), Parameter := "Wholesale Price"]
plotdata[Parameter %in% c("CO2 Tax Biogas", "CO2 Tax Pt-LNG", "CO2 Tax LNG", "CO2 Tax LNG Mix"), Parameter := "CO2 Tax"]
plotdata[Parameter %in% c("Excise Duty - biogas", "Excise Duty - Pt-LNG", "Excise Duty - LNG", "Excise Duty - LNG Mix"), Parameter := "Excise Duty"]
plotdata <- plotdata[, Parameter := factor(Parameter, levels = c( "Total Mark-Up", "CO2 Tax", "Excise Duty", "Wholesale Price"))]
plotdata[, `Type` := factor(`Type`, levels = c("Fossil LNG", "Bio Gas", "PT LNG", "LNG Mix"))]
plotdata[period == 2020 & Type == "PT LNG", value := 0]

p <- ggplot(plotdata[Country %in% Countries_plotted & period %in% yrs], aes(fill=Parameter, y=value, x=`Type`)) + theme(panel.grid.major=element_line(colour='#adadad'), panel.grid.minor=element_line(colour='#adadad')) +
    geom_bar(position="stack", stat="identity")+
      facet_wrap(`Fuel-Scenario` ~ period, nrow = 1, scales = "free")+
      facet_grid(`Fuel-Scenario` ~ period) + theme_bw()+
      theme(text = element_text(size = textSize))+
      scale_x_discrete(labels=function(x){sub("\\s", "\n", x)}) +
      labs(y = paste0("Diesel Prices [EUR/kWh]")) + #, title = "Diesel Mix Prices") +
      scale_fill_manual(values=colorbarDie)
plot(p)

```

## Comparison plots LNG: Fossil vs Bio vs Syn vs Mix [EUR/kg]
```{r , include=TRUE, fig.width = 30,fig.height = 10}
yrs <- c(2020, 2030, 2035, 2040)
LNG_kWh_pro_kg <- 12.53

plotdata <- rbind(BioLNG,PtLNG, LNG, LNG_Mix)
plotdata[, value := value*LNG_kWh_pro_kg][, unit := "EUR/kg"]
plotdata[Parameter %in% c("Total NG Mark-Up"), Parameter := "Total Mark-Up"]
plotdata[Parameter %in% c("Wholesale Biogas Price", "Wholesale Pt-LNG Price", "Wholesale LNG Price", "Wholesale LNG Price (Mix)"), Parameter := "Wholesale Price"]
plotdata[Parameter %in% c("CO2 Tax Biogas", "CO2 Tax Pt-LNG", "CO2 Tax LNG", "CO2 Tax LNG Mix"), Parameter := "CO2 Tax"]
plotdata[Parameter %in% c("Excise Duty - biogas", "Excise Duty - Pt-LNG", "Excise Duty - LNG", "Excise Duty - LNG Mix"), Parameter := "Excise Duty"]
plotdata <- plotdata[, Parameter := factor(Parameter, levels = c( "Total Mark-Up", "CO2 Tax", "Excise Duty", "Wholesale Price"))]
plotdata[, `Type` := factor(`Type`, levels = c("Fossil LNG", "Bio Gas", "PT LNG", "LNG Mix"))]
plotdata[period == 2020 & Type == "PT LNG", value := 0]

p <- ggplot(plotdata[Country %in% Countries_plotted & period %in% yrs], aes(fill=Parameter, y=value, x=`Type`)) + theme(panel.grid.major=element_line(colour='#adadad'), panel.grid.minor=element_line(colour='#adadad')) +
    geom_bar(position="stack", stat="identity")+
      facet_wrap(`Fuel-Scenario` ~ period, nrow = 1, scales = "free")+
      facet_grid(`Fuel-Scenario` ~ period) + theme_bw()+
      theme(text = element_text(size = textSize))+
      scale_x_discrete(labels=function(x){sub("\\s", "\n", x)}) +
      labs(y = paste0("LNG Prices [EUR/kg]")) + #, title = "Diesel Mix Prices") +
      scale_fill_manual(values=colorbarDie)
plot(p)

```

# Italy
## Hydrogen Enduse Prices [EUR/kWh]
```{r , include=TRUE, fig.width = 30,fig.height = 10}
Countries_plotted <- c("IT")
yrs <- c(2030, 2040, 2050)
```

```{r , include=TRUE, fig.width = 30,fig.height = 10}
p <- ggplot(Hydrogen[Country %in% Countries_plotted & period %in% yrs], aes(fill=Parameter, y=value, x=`period`)) + theme(panel.grid.major=element_line(colour='#adadad'), panel.grid.minor=element_line(colour='#adadad')) +
    geom_bar(position="stack", stat="identity")+
      facet_grid(~ `Fuel-Scenario`, scales = "free")+
      theme(text = element_text(size = textSize))+
      labs(y = paste0("Hydrogen Price [EUR/kWh]")) + #, title = "Hydrogen Prices for different Fuel Scenarios") +
      scale_x_continuous(breaks = c(2030, 2040, 2050)) +
      scale_fill_manual(values=colorbarHydrogen)
plot(p)

```

## Hydrogen Enduse Prices [EUR/kg]
```{r , include=TRUE, fig.width = 30,fig.height = 10}
HydrogenKg <- copy(Hydrogen)
HydrogenKg[, `kWh/kg H2` := 33.33]
HydrogenKg[, value := value*`kWh/kg H2`][, unit := "EUR/kg"]

p <- ggplot(HydrogenKg[Country %in% Countries_plotted & period %in% yrs], aes(fill=Parameter, y=value, x=`period`)) + theme(panel.grid.major=element_line(colour='#adadad'), panel.grid.minor=element_line(colour='#adadad')) +
    geom_bar(position="stack", stat="identity")+
      facet_grid(~ `Fuel-Scenario`, scales = "free")+
      theme(text = element_text(size = textSize))+
      labs(y = paste0("Hydrogen Price [EUR/kg]")) + #, title = "Hydrogen Prices for different Fuel Scenarios") +
      scale_x_continuous(breaks = c(2030, 2040, 2050)) +
      scale_fill_manual(values=colorbarHydrogen)
plot(p)

```

## Electricity Enduse Prices Depot Charging [EUR/kWh]
```{r , include=TRUE, fig.width = 30,fig.height = 10}
p <- ggplot(Electricity_Depot[Country %in% Countries_plotted & period %in% yrs], aes(fill=Parameter, y=value, x=`period`)) + theme(panel.grid.major=element_line(colour='#adadad'), panel.grid.minor=element_line(colour='#adadad')) +
    geom_bar(position="stack", stat="identity")+
      facet_grid(~ `Fuel-Scenario`, scales = "free")+
      theme(text = element_text(size = textSize))+
      labs(y = paste0("Enduse Electricity Price [EUR/kWh]")) + #, title = "Electricity Prices Depot Charging") +
      scale_x_continuous(breaks = c(2030, 2040, 2050)) +
      scale_fill_manual(values=colorbarElec_CCS)
plot(p)

```

## Electricity Enduse Prices MCS Charging [EUR/kWh]
```{r , include=TRUE, fig.width = 30,fig.height = 10}
p <- ggplot(Electricity_MCS[Country %in% Countries_plotted & period %in% yrs], aes(fill=Parameter, y=value, x=`period`)) + theme(panel.grid.major=element_line(colour='#adadad'), panel.grid.minor=element_line(colour='#adadad')) +
    geom_bar(position="stack", stat="identity")+
      facet_grid(~ `Fuel-Scenario`, scales = "free")+
      theme(text = element_text(size = textSize))+
      labs(y = paste0("Enduse Electricity Price [EUR/kWh]")) + #, title = "Electricity Prices MCS Charging") +
      scale_x_continuous(breaks = c(2030, 2040, 2050)) +
      scale_fill_manual(values=colorbarElec_MCS)
plot(p)

```

## Diesel Mix Enduse Prices [EUR/kWh]
```{r , include=TRUE, fig.width = 30,fig.height = 10}
p <- ggplot(Diesel_Mix[Country %in% Countries_plotted & period %in% yrs], aes(fill=Parameter, y=value, x=`period`)) + theme(panel.grid.major=element_line(colour='#adadad'), panel.grid.minor=element_line(colour='#adadad')) +
    geom_bar(position="stack", stat="identity")+
      facet_grid(~ `Fuel-Scenario`, scales = "free")+
      theme(text = element_text(size = textSize))+
      labs(y = paste0("Enduse Diesel Mix Price [EUR/kWh]")) + #, title = "Diesel Mix Prices") +
      scale_x_continuous(breaks = c(2030, 2040, 2050)) +
      scale_fill_manual(values=colorbarDie)
plot(p)

```

## Fossil Diesel Enduse Prices [EUR/kWh]
```{r , include=TRUE, fig.width = 30,fig.height = 10}
p <- ggplot(Diesel[Country %in% Countries_plotted & period %in% yrs], aes(fill=Parameter, y=value, x=`period`)) + theme(panel.grid.major=element_line(colour='#adadad'), panel.grid.minor=element_line(colour='#adadad')) +
    geom_bar(position="stack", stat="identity")+
      facet_grid(~ `Fuel-Scenario`, scales = "free")+
      theme(text = element_text(size = textSize))+
      labs(y = paste0("Enduse Fossil Diesel Price [EUR/kWh]")) + #, title = "Diesel Mix Prices") +
      scale_x_continuous(breaks = c(2030, 2040, 2050)) +
      scale_fill_manual(values=colorbarDie)
plot(p)

```

## Pt-Diesel Enduse Prices [EUR/kWh]
```{r , include=TRUE, fig.width = 30,fig.height = 10}
p <- ggplot(PtDiesel[Country %in% Countries_plotted & period %in% yrs], aes(fill=Parameter, y=value, x=`period`)) + theme(panel.grid.major=element_line(colour='#adadad'), panel.grid.minor=element_line(colour='#adadad')) +
    geom_bar(position="stack", stat="identity")+
      facet_grid(~ `Fuel-Scenario`, scales = "free")+
      theme(text = element_text(size = textSize))+
      labs(y = paste0("Enduse Pt-Diesel Price [EUR/kWh]")) + #, title = "Diesel Mix Prices") +
      scale_x_continuous(breaks = c(2030, 2040, 2050)) +
      scale_fill_manual(values=colorbarDie)
plot(p)

```

## Biodiesel Enduse Prices [EUR/kWh]
```{r , include=TRUE, fig.width = 30,fig.height = 10}
p <- ggplot(BioDiesel[Country %in% Countries_plotted & period %in% yrs], aes(fill=Parameter, y=value, x=`period`)) + theme(panel.grid.major=element_line(colour='#adadad'), panel.grid.minor=element_line(colour='#adadad')) +
    geom_bar(position="stack", stat="identity")+
      facet_grid(~ `Fuel-Scenario`, scales = "free")+
      theme(text = element_text(size = textSize))+
      labs(y = paste0("Enduse Biodiesel Price [EUR/kWh]")) + #, title = "Diesel Mix Prices") +
      scale_x_continuous(breaks = c(2030, 2040, 2050)) +
      scale_fill_manual(values=colorbarDie)
plot(p)

```

## LNG Mix Enduse Prices [EUR/kWh]
```{r , include=TRUE, fig.width = 30,fig.height = 10}
p <- ggplot(LNG_Mix[Country %in% Countries_plotted & period %in% yrs], aes(fill=Parameter, y=value, x=`period`)) + theme(panel.grid.major=element_line(colour='#adadad'), panel.grid.minor=element_line(colour='#adadad')) +
    geom_bar(position="stack", stat="identity")+
      facet_grid(~ `Fuel-Scenario`, scales = "free")+
      theme(text = element_text(size = textSize))+
      labs(y = paste0("Enduse LNG Mix Price [EUR/kWh]")) + #, title = "LNG Mix Prices") +
      scale_x_continuous(breaks = c(2030, 2040, 2050)) +
      scale_fill_manual(values=colorbarLNG)
plot(p)
```

## Fossil LNG Enduse Prices [EUR/kWh]
```{r , include=TRUE, fig.width = 30,fig.height = 10}
p <- ggplot(LNG[Country %in% Countries_plotted & period %in% yrs], aes(fill=Parameter, y=value, x=`period`)) + theme(panel.grid.major=element_line(colour='#adadad'), panel.grid.minor=element_line(colour='#adadad')) +
    geom_bar(position="stack", stat="identity")+
      facet_grid(~ `Fuel-Scenario`, scales = "free")+
      theme(text = element_text(size = textSize))+
      labs(y = paste0("Enduse Fossil LNG Price [EUR/kWh]")) + #, title = "Diesel Mix Prices") +
      scale_x_continuous(breaks = c(2030, 2040, 2050)) +
      scale_fill_manual(values=colorbarDie)
plot(p)

```

## Pt-LNG Enduse Prices [EUR/kWh]
```{r , include=TRUE, fig.width = 30,fig.height = 10}
p <- ggplot(PtLNG[Country %in% Countries_plotted & period %in% yrs], aes(fill=Parameter, y=value, x=`period`)) + theme(panel.grid.major=element_line(colour='#adadad'), panel.grid.minor=element_line(colour='#adadad')) +
    geom_bar(position="stack", stat="identity")+
      facet_grid(~ `Fuel-Scenario`, scales = "free")+
      theme(text = element_text(size = textSize))+
      labs(y = paste0("Enduse Pt-LNG Price [EUR/kWh]")) + #, title = "Diesel Mix Prices") +
      scale_x_continuous(breaks = c(2030, 2040, 2050)) +
      scale_fill_manual(values=colorbarDie)
plot(p)

```

## Biogas Enduse Prices [EUR/kWh]
```{r , include=TRUE, fig.width = 30,fig.height = 10}
p <- ggplot(BioLNG[Country %in% Countries_plotted & period %in% yrs], aes(fill=Parameter, y=value, x=`period`)) + theme(panel.grid.major=element_line(colour='#adadad'), panel.grid.minor=element_line(colour='#adadad')) +
    geom_bar(position="stack", stat="identity")+
      facet_grid(~ `Fuel-Scenario`, scales = "free")+
      theme(text = element_text(size = textSize))+
      labs(y = paste0("Enduse Biogas Price [EUR/kWh]")) + #, title = "Diesel Mix Prices") +
      scale_x_continuous(breaks = c(2030, 2040, 2050)) +
      scale_fill_manual(values=colorbarDie)
plot(p)

```

## Comparison plots Diesel: Fossil vs Bio vs Syn vs Mix [EUR/kWh]
```{r , include=TRUE, fig.width = 30,fig.height = 10}

yrs <- c(2020, 2030, 2035, 2040)
plotdata <- rbind(BioDiesel,PtDiesel, Diesel, Diesel_Mix)
plotdata[Parameter %in% c("Total Diesel Mark-Up"), Parameter := "Total Mark-Up"]
plotdata[Parameter %in% c("Wholesale Biodiesel Price", "Wholesale PT-Diesel Price", "Wholesale Diesel Price", "Wholesale Diesel Price (Mix)"), Parameter := "Wholesale Price"]
plotdata[Parameter %in% c("CO2 Tax Biodiesel", "CO2 Tax Pt-Diesel", "CO2 Tax Diesel", "CO2 Tax Diesel Mix"), Parameter := "CO2 Tax"]
plotdata[Parameter %in% c("Excise Duty - biodiesel", "Excise Duty - Synthetic Diesel (E-Fuels)", "Excise Duty - Diesel", "Excise Duty - Diesel Mix"), Parameter := "Excise Duty"]
plotdata <- plotdata[, Parameter := factor(Parameter, levels = c( "Total Mark-Up", "CO2 Tax", "Excise Duty", "Wholesale Price"))]
plotdata[, `Type` := factor(`Type`, levels = c("Fossil Diesel", "Bio Diesel", "PT Diesel", "Diesel Mix"))]
plotdata[period == 2020 & Type == "PT Diesel", value := 0]

p <- ggplot(plotdata[Country %in% Countries_plotted & period %in% yrs], aes(fill=Parameter, y=value, x=`Type`)) + theme(panel.grid.major=element_line(colour='#adadad'), panel.grid.minor=element_line(colour='#adadad')) +
    geom_bar(position="stack", stat="identity")+
      facet_wrap(`Fuel-Scenario` ~ period, nrow = 1, scales = "free")+
      facet_grid(`Fuel-Scenario` ~ period) + theme_bw()+
      theme(text = element_text(size = textSize))+
      scale_x_discrete(labels=function(x){sub("\\s", "\n", x)}) +
      labs(y = paste0("Diesel Prices [EUR/kWh]")) + #, title = "Diesel Mix Prices") +
      scale_fill_manual(values=colorbarDie)
plot(p)

```

## Comparison plots Diesel: Fossil vs Bio vs Syn vs Mix [EUR/l]
```{r , include=TRUE, fig.width = 30,fig.height = 10}
Diesel_kWh_pro_l <- 9.97
BioDiesel_kWh_pro_l <- 9.11

yrs <- c(2020, 2030, 2035, 2040)
plotdata <- rbind(BioDiesel,PtDiesel, Diesel, Diesel_Mix)
plotdata[, value := ifelse(Type== "Biodiesel", value*BioDiesel_kWh_pro_l, value*Diesel_kWh_pro_l)][, unit := "EUR/l"]
plotdata[Parameter %in% c("Total Diesel Mark-Up"), Parameter := "Total Mark-Up"]
plotdata[Parameter %in% c("Wholesale Biodiesel Price", "Wholesale PT-Diesel Price", "Wholesale Diesel Price", "Wholesale Diesel Price (Mix)"), Parameter := "Wholesale Price"]
plotdata[Parameter %in% c("CO2 Tax Biodiesel", "CO2 Tax Pt-Diesel", "CO2 Tax Diesel", "CO2 Tax Diesel Mix"), Parameter := "CO2 Tax"]
plotdata[Parameter %in% c("Excise Duty - biodiesel", "Excise Duty - Synthetic Diesel (E-Fuels)", "Excise Duty - Diesel", "Excise Duty - Diesel Mix"), Parameter := "Excise Duty"]
plotdata <- plotdata[, Parameter := factor(Parameter, levels = c( "Total Mark-Up", "CO2 Tax", "Excise Duty", "Wholesale Price"))]
plotdata[, `Type` := factor(`Type`, levels = c("Fossil Diesel", "Bio Diesel", "PT Diesel", "Diesel Mix"))]
#Set PT-Diesel Price to zero in 2020 because there is not quantity
plotdata[period == 2020 & Type == "PT Diesel", value := 0]

p <- ggplot(plotdata[Country %in% Countries_plotted & period %in% yrs], aes(fill=Parameter, y=value, x=`Type`)) + theme(panel.grid.major=element_line(colour='#adadad'), panel.grid.minor=element_line(colour='#adadad')) +
    geom_bar(position="stack", stat="identity")+
      facet_wrap(`Fuel-Scenario` ~ period, nrow = 1, scales = "free")+
      facet_grid(`Fuel-Scenario` ~ period) + theme_bw()+
      theme(text = element_text(size = textSize))+
      scale_x_discrete(labels=function(x){sub("\\s", "\n", x)}) +
      labs(y = paste0("Diesel Prices [EUR/l]")) + #, title = "Diesel Mix Prices") +
      scale_fill_manual(values=colorbarDie)
plot(p)

```

## Comparison plots LNG: Fossil vs Bio vs Syn vs Mix [EUR/kWh]
```{r , include=TRUE, fig.width = 30,fig.height = 10}
yrs <- c(2020, 2030, 2035, 2040)
plotdata <- rbind(BioLNG,PtLNG, LNG, LNG_Mix)
plotdata[Parameter %in% c("Total NG Mark-Up"), Parameter := "Total Mark-Up"]
plotdata[Parameter %in% c("Wholesale Biogas Price", "Wholesale Pt-LNG Price", "Wholesale LNG Price", "Wholesale LNG Price (Mix)"), Parameter := "Wholesale Price"]
plotdata[Parameter %in% c("CO2 Tax Biogas", "CO2 Tax Pt-LNG", "CO2 Tax LNG", "CO2 Tax LNG Mix"), Parameter := "CO2 Tax"]
plotdata[Parameter %in% c("Excise Duty - biogas", "Excise Duty - Pt-LNG", "Excise Duty - LNG", "Excise Duty - LNG Mix"), Parameter := "Excise Duty"]
plotdata <- plotdata[, Parameter := factor(Parameter, levels = c( "Total Mark-Up", "CO2 Tax", "Excise Duty", "Wholesale Price"))]
plotdata[, `Type` := factor(`Type`, levels = c("Fossil LNG", "Bio Gas", "PT LNG", "LNG Mix"))]
plotdata[period == 2020 & Type == "PT LNG", value := 0]

p <- ggplot(plotdata[Country %in% Countries_plotted & period %in% yrs], aes(fill=Parameter, y=value, x=`Type`)) + theme(panel.grid.major=element_line(colour='#adadad'), panel.grid.minor=element_line(colour='#adadad')) +
    geom_bar(position="stack", stat="identity")+
      facet_wrap(`Fuel-Scenario` ~ period, nrow = 1, scales = "free")+
      facet_grid(`Fuel-Scenario` ~ period) + theme_bw()+
      theme(text = element_text(size = textSize))+
      scale_x_discrete(labels=function(x){sub("\\s", "\n", x)}) +
      labs(y = paste0("Diesel Prices [EUR/kWh]")) + #, title = "Diesel Mix Prices") +
      scale_fill_manual(values=colorbarDie)
plot(p)

```

## Comparison plots LNG: Fossil vs Bio vs Syn vs Mix [EUR/kg]
```{r , include=TRUE, fig.width = 30,fig.height = 10}
yrs <- c(2020, 2030, 2035, 2040)
LNG_kWh_pro_kg <- 12.53

plotdata <- rbind(BioLNG,PtLNG, LNG, LNG_Mix)
plotdata[, value := value*LNG_kWh_pro_kg][, unit := "EUR/kg"]
plotdata[Parameter %in% c("Total NG Mark-Up"), Parameter := "Total Mark-Up"]
plotdata[Parameter %in% c("Wholesale Biogas Price", "Wholesale Pt-LNG Price", "Wholesale LNG Price", "Wholesale LNG Price (Mix)"), Parameter := "Wholesale Price"]
plotdata[Parameter %in% c("CO2 Tax Biogas", "CO2 Tax Pt-LNG", "CO2 Tax LNG", "CO2 Tax LNG Mix"), Parameter := "CO2 Tax"]
plotdata[Parameter %in% c("Excise Duty - biogas", "Excise Duty - Pt-LNG", "Excise Duty - LNG", "Excise Duty - LNG Mix"), Parameter := "Excise Duty"]
plotdata <- plotdata[, Parameter := factor(Parameter, levels = c( "Total Mark-Up", "CO2 Tax", "Excise Duty", "Wholesale Price"))]
plotdata[, `Type` := factor(`Type`, levels = c("Fossil LNG", "Bio Gas", "PT LNG", "LNG Mix"))]
plotdata[period == 2020 & Type == "PT LNG", value := 0]

p <- ggplot(plotdata[Country %in% Countries_plotted & period %in% yrs], aes(fill=Parameter, y=value, x=`Type`)) + theme(panel.grid.major=element_line(colour='#adadad'), panel.grid.minor=element_line(colour='#adadad')) +
    geom_bar(position="stack", stat="identity")+
      facet_wrap(`Fuel-Scenario` ~ period, nrow = 1, scales = "free")+
      facet_grid(`Fuel-Scenario` ~ period) + theme_bw()+
      theme(text = element_text(size = textSize))+
      scale_x_discrete(labels=function(x){sub("\\s", "\n", x)}) +
      labs(y = paste0("LNG Prices [EUR/kg]")) + #, title = "Diesel Mix Prices") +
      scale_fill_manual(values=colorbarDie)
plot(p)

```

# Poland
## Hydrogen Enduse Prices [EUR/kWh]
```{r , include=TRUE, fig.width = 30,fig.height = 10}
Countries_plotted <- c("PL")
yrs <- c(2030, 2040, 2050)
```

```{r , include=TRUE, fig.width = 30,fig.height = 10}
p <- ggplot(Hydrogen[Country %in% Countries_plotted & period %in% yrs], aes(fill=Parameter, y=value, x=`period`)) + theme(panel.grid.major=element_line(colour='#adadad'), panel.grid.minor=element_line(colour='#adadad')) +
    geom_bar(position="stack", stat="identity")+
      facet_grid(~ `Fuel-Scenario`, scales = "free")+
      theme(text = element_text(size = textSize))+
      labs(y = paste0("Hydrogen Price [EUR/kWh]")) + #, title = "Hydrogen Prices for different Fuel Scenarios") +
      scale_x_continuous(breaks = c(2030, 2040, 2050)) +
      scale_fill_manual(values=colorbarHydrogen)
plot(p)

```

## Hydrogen Enduse Prices [EUR/kg]
```{r , include=TRUE, fig.width = 30,fig.height = 10}
HydrogenKg <- copy(Hydrogen)
HydrogenKg[, `kWh/kg H2` := 33.33]
HydrogenKg[, value := value*`kWh/kg H2`][, unit := "EUR/kg"]

p <- ggplot(HydrogenKg[Country %in% Countries_plotted & period %in% yrs], aes(fill=Parameter, y=value, x=`period`)) + theme(panel.grid.major=element_line(colour='#adadad'), panel.grid.minor=element_line(colour='#adadad')) +
    geom_bar(position="stack", stat="identity")+
      facet_grid(~ `Fuel-Scenario`, scales = "free")+
      theme(text = element_text(size = textSize))+
      labs(y = paste0("Hydrogen Price [EUR/kg]")) + #, title = "Hydrogen Prices for different Fuel Scenarios") +
      scale_x_continuous(breaks = c(2030, 2040, 2050)) +
      scale_fill_manual(values=colorbarHydrogen)
plot(p)

```

## Electricity Enduse Prices Depot Charging [EUR/kWh]
```{r , include=TRUE, fig.width = 30,fig.height = 10}
p <- ggplot(Electricity_Depot[Country %in% Countries_plotted & period %in% yrs], aes(fill=Parameter, y=value, x=`period`)) + theme(panel.grid.major=element_line(colour='#adadad'), panel.grid.minor=element_line(colour='#adadad')) +
    geom_bar(position="stack", stat="identity")+
      facet_grid(~ `Fuel-Scenario`, scales = "free")+
      theme(text = element_text(size = textSize))+
      labs(y = paste0("Enduse Electricity Price [EUR/kWh]")) + #, title = "Electricity Prices Depot Charging") +
      scale_x_continuous(breaks = c(2030, 2040, 2050)) +
      scale_fill_manual(values=colorbarElec_CCS)
plot(p)

```

## Electricity Enduse Prices MCS Charging [EUR/kWh]
```{r , include=TRUE, fig.width = 30,fig.height = 10}
p <- ggplot(Electricity_MCS[Country %in% Countries_plotted & period %in% yrs], aes(fill=Parameter, y=value, x=`period`)) + theme(panel.grid.major=element_line(colour='#adadad'), panel.grid.minor=element_line(colour='#adadad')) +
    geom_bar(position="stack", stat="identity")+
      facet_grid(~ `Fuel-Scenario`, scales = "free")+
      theme(text = element_text(size = textSize))+
      labs(y = paste0("Enduse Electricity Price [EUR/kWh]")) + #, title = "Electricity Prices MCS Charging") +
      scale_x_continuous(breaks = c(2030, 2040, 2050)) +
      scale_fill_manual(values=colorbarElec_MCS)
plot(p)

```

## Diesel Mix Enduse Prices [EUR/kWh]
```{r , include=TRUE, fig.width = 30,fig.height = 10}
p <- ggplot(Diesel_Mix[Country %in% Countries_plotted & period %in% yrs], aes(fill=Parameter, y=value, x=`period`)) + theme(panel.grid.major=element_line(colour='#adadad'), panel.grid.minor=element_line(colour='#adadad')) +
    geom_bar(position="stack", stat="identity")+
      facet_grid(~ `Fuel-Scenario`, scales = "free")+
      theme(text = element_text(size = textSize))+
      labs(y = paste0("Enduse Diesel Mix Price [EUR/kWh]")) + #, title = "Diesel Mix Prices") +
      scale_x_continuous(breaks = c(2030, 2040, 2050)) +
      scale_fill_manual(values=colorbarDie)
plot(p)

```

## Fossil Diesel Enduse Prices [EUR/kWh]
```{r , include=TRUE, fig.width = 30,fig.height = 10}
p <- ggplot(Diesel[Country %in% Countries_plotted & period %in% yrs], aes(fill=Parameter, y=value, x=`period`)) + theme(panel.grid.major=element_line(colour='#adadad'), panel.grid.minor=element_line(colour='#adadad')) +
    geom_bar(position="stack", stat="identity")+
      facet_grid(~ `Fuel-Scenario`, scales = "free")+
      theme(text = element_text(size = textSize))+
      labs(y = paste0("Enduse Fossil Diesel Price [EUR/kWh]")) + #, title = "Diesel Mix Prices") +
      scale_x_continuous(breaks = c(2030, 2040, 2050)) +
      scale_fill_manual(values=colorbarDie)
plot(p)

```

## Pt-Diesel Enduse Prices [EUR/kWh]
```{r , include=TRUE, fig.width = 30,fig.height = 10}
p <- ggplot(PtDiesel[Country %in% Countries_plotted & period %in% yrs], aes(fill=Parameter, y=value, x=`period`)) + theme(panel.grid.major=element_line(colour='#adadad'), panel.grid.minor=element_line(colour='#adadad')) +
    geom_bar(position="stack", stat="identity")+
      facet_grid(~ `Fuel-Scenario`, scales = "free")+
      theme(text = element_text(size = textSize))+
      labs(y = paste0("Enduse Pt-Diesel Price [EUR/kWh]")) + #, title = "Diesel Mix Prices") +
      scale_x_continuous(breaks = c(2030, 2040, 2050)) +
      scale_fill_manual(values=colorbarDie)
plot(p)

```

## Biodiesel Enduse Prices [EUR/kWh]
```{r , include=TRUE, fig.width = 30,fig.height = 10}
p <- ggplot(BioDiesel[Country %in% Countries_plotted & period %in% yrs], aes(fill=Parameter, y=value, x=`period`)) + theme(panel.grid.major=element_line(colour='#adadad'), panel.grid.minor=element_line(colour='#adadad')) +
    geom_bar(position="stack", stat="identity")+
      facet_grid(~ `Fuel-Scenario`, scales = "free")+
      theme(text = element_text(size = textSize))+
      labs(y = paste0("Enduse Biodiesel Price [EUR/kWh]")) + #, title = "Diesel Mix Prices") +
      scale_x_continuous(breaks = c(2030, 2040, 2050)) +
      scale_fill_manual(values=colorbarDie)
plot(p)

```

## LNG Mix Enduse Prices [EUR/kWh]
```{r , include=TRUE, fig.width = 30,fig.height = 10}
p <- ggplot(LNG_Mix[Country %in% Countries_plotted & period %in% yrs], aes(fill=Parameter, y=value, x=`period`)) + theme(panel.grid.major=element_line(colour='#adadad'), panel.grid.minor=element_line(colour='#adadad')) +
    geom_bar(position="stack", stat="identity")+
      facet_grid(~ `Fuel-Scenario`, scales = "free")+
      theme(text = element_text(size = textSize))+
      labs(y = paste0("Enduse LNG Mix Price [EUR/kWh]")) + #, title = "LNG Mix Prices") +
      scale_x_continuous(breaks = c(2030, 2040, 2050)) +
      scale_fill_manual(values=colorbarLNG)
plot(p)
```

## Fossil LNG Enduse Prices [EUR/kWh]
```{r , include=TRUE, fig.width = 30,fig.height = 10}
p <- ggplot(LNG[Country %in% Countries_plotted & period %in% yrs], aes(fill=Parameter, y=value, x=`period`)) + theme(panel.grid.major=element_line(colour='#adadad'), panel.grid.minor=element_line(colour='#adadad')) +
    geom_bar(position="stack", stat="identity")+
      facet_grid(~ `Fuel-Scenario`, scales = "free")+
      theme(text = element_text(size = textSize))+
      labs(y = paste0("Enduse Fossil LNG Price [EUR/kWh]")) + #, title = "Diesel Mix Prices") +
      scale_x_continuous(breaks = c(2030, 2040, 2050)) +
      scale_fill_manual(values=colorbarDie)
plot(p)

```

## Pt-LNG Enduse Prices [EUR/kWh]
```{r , include=TRUE, fig.width = 30,fig.height = 10}
p <- ggplot(PtLNG[Country %in% Countries_plotted & period %in% yrs], aes(fill=Parameter, y=value, x=`period`)) + theme(panel.grid.major=element_line(colour='#adadad'), panel.grid.minor=element_line(colour='#adadad')) +
    geom_bar(position="stack", stat="identity")+
      facet_grid(~ `Fuel-Scenario`, scales = "free")+
      theme(text = element_text(size = textSize))+
      labs(y = paste0("Enduse Pt-LNG Price [EUR/kWh]")) + #, title = "Diesel Mix Prices") +
      scale_x_continuous(breaks = c(2030, 2040, 2050)) +
      scale_fill_manual(values=colorbarDie)
plot(p)

```

## Biogas Enduse Prices [EUR/kWh]
```{r , include=TRUE, fig.width = 30,fig.height = 10}
p <- ggplot(BioLNG[Country %in% Countries_plotted & period %in% yrs], aes(fill=Parameter, y=value, x=`period`)) + theme(panel.grid.major=element_line(colour='#adadad'), panel.grid.minor=element_line(colour='#adadad')) +
    geom_bar(position="stack", stat="identity")+
      facet_grid(~ `Fuel-Scenario`, scales = "free")+
      theme(text = element_text(size = textSize))+
      labs(y = paste0("Enduse Biogas Price [EUR/kWh]")) + #, title = "Diesel Mix Prices") +
      scale_x_continuous(breaks = c(2030, 2040, 2050)) +
      scale_fill_manual(values=colorbarDie)
plot(p)

```

## Comparison plots Diesel: Fossil vs Bio vs Syn vs Mix [EUR/kWh]
```{r , include=TRUE, fig.width = 30,fig.height = 10}
yrs <- c(2020, 2030, 2035, 2040)

plotdata <- rbind(BioDiesel,PtDiesel, Diesel, Diesel_Mix)
plotdata[Parameter %in% c("Total Diesel Mark-Up"), Parameter := "Total Mark-Up"]
plotdata[Parameter %in% c("Wholesale Biodiesel Price", "Wholesale PT-Diesel Price", "Wholesale Diesel Price", "Wholesale Diesel Price (Mix)"), Parameter := "Wholesale Price"]
plotdata[Parameter %in% c("CO2 Tax Biodiesel", "CO2 Tax Pt-Diesel", "CO2 Tax Diesel", "CO2 Tax Diesel Mix"), Parameter := "CO2 Tax"]
plotdata[Parameter %in% c("Excise Duty - biodiesel", "Excise Duty - Synthetic Diesel (E-Fuels)", "Excise Duty - Diesel", "Excise Duty - Diesel Mix"), Parameter := "Excise Duty"]
plotdata <- plotdata[, Parameter := factor(Parameter, levels = c( "Total Mark-Up", "CO2 Tax", "Excise Duty", "Wholesale Price"))]
plotdata[, `Type` := factor(`Type`, levels = c("Fossil Diesel", "Bio Diesel", "PT Diesel", "Diesel Mix"))]
plotdata[period == 2020 & Type == "PT Diesel", value := 0]

p <- ggplot(plotdata[Country %in% Countries_plotted & period %in% yrs], aes(fill=Parameter, y=value, x=`Type`)) + theme(panel.grid.major=element_line(colour='#adadad'), panel.grid.minor=element_line(colour='#adadad')) +
    geom_bar(position="stack", stat="identity")+
      facet_wrap(`Fuel-Scenario` ~ period, nrow = 1, scales = "free")+
      facet_grid(`Fuel-Scenario` ~ period) + theme_bw()+
      theme(text = element_text(size = textSize))+
      scale_x_discrete(labels=function(x){sub("\\s", "\n", x)}) +
      labs(y = paste0("Diesel Prices [EUR/kWh]")) + #, title = "Diesel Mix Prices") +
      scale_fill_manual(values=colorbarDie)
plot(p)

```

## Comparison plots Diesel: Fossil vs Bio vs Syn vs Mix [EUR/l]
```{r , include=TRUE, fig.width = 30,fig.height = 10}
Diesel_kWh_pro_l <- 9.97
BioDiesel_kWh_pro_l <- 9.11

yrs <- c(2020, 2030, 2035, 2040)
plotdata <- rbind(BioDiesel,PtDiesel, Diesel, Diesel_Mix)
plotdata[, value := ifelse(Type== "Biodiesel", value*BioDiesel_kWh_pro_l, value*Diesel_kWh_pro_l)][, unit := "EUR/l"]
plotdata[Parameter %in% c("Total Diesel Mark-Up"), Parameter := "Total Mark-Up"]
plotdata[Parameter %in% c("Wholesale Biodiesel Price", "Wholesale PT-Diesel Price", "Wholesale Diesel Price", "Wholesale Diesel Price (Mix)"), Parameter := "Wholesale Price"]
plotdata[Parameter %in% c("CO2 Tax Biodiesel", "CO2 Tax Pt-Diesel", "CO2 Tax Diesel", "CO2 Tax Diesel Mix"), Parameter := "CO2 Tax"]
plotdata[Parameter %in% c("Excise Duty - biodiesel", "Excise Duty - Synthetic Diesel (E-Fuels)", "Excise Duty - Diesel", "Excise Duty - Diesel Mix"), Parameter := "Excise Duty"]
plotdata <- plotdata[, Parameter := factor(Parameter, levels = c( "Total Mark-Up", "CO2 Tax", "Excise Duty", "Wholesale Price"))]
plotdata[, `Type` := factor(`Type`, levels = c("Fossil Diesel", "Bio Diesel", "PT Diesel", "Diesel Mix"))]
#Set PT-Diesel Price to zero in 2020 because there is not quantity
plotdata[period == 2020 & Type == "PT Diesel", value := 0]

p <- ggplot(plotdata[Country %in% Countries_plotted & period %in% yrs], aes(fill=Parameter, y=value, x=`Type`)) + theme(panel.grid.major=element_line(colour='#adadad'), panel.grid.minor=element_line(colour='#adadad')) +
    geom_bar(position="stack", stat="identity")+
      facet_wrap(`Fuel-Scenario` ~ period, nrow = 1, scales = "free")+
      facet_grid(`Fuel-Scenario` ~ period) + theme_bw()+
      theme(text = element_text(size = textSize))+
      scale_x_discrete(labels=function(x){sub("\\s", "\n", x)}) +
      labs(y = paste0("Diesel Prices [EUR/l]")) + #, title = "Diesel Mix Prices") +
      scale_fill_manual(values=colorbarDie)
plot(p)

```

## Comparison plots LNG: Fossil vs Bio vs Syn vs Mix [EUR/kWh]
```{r , include=TRUE, fig.width = 30,fig.height = 10}
yrs <- c(2020, 2030, 2035, 2040)

plotdata <- rbind(BioLNG,PtLNG, LNG, LNG_Mix)
plotdata[Parameter %in% c("Total NG Mark-Up"), Parameter := "Total Mark-Up"]
plotdata[Parameter %in% c("Wholesale Biogas Price", "Wholesale Pt-LNG Price", "Wholesale LNG Price", "Wholesale LNG Price (Mix)"), Parameter := "Wholesale Price"]
plotdata[Parameter %in% c("CO2 Tax Biogas", "CO2 Tax Pt-LNG", "CO2 Tax LNG", "CO2 Tax LNG Mix"), Parameter := "CO2 Tax"]
plotdata[Parameter %in% c("Excise Duty - biogas", "Excise Duty - Pt-LNG", "Excise Duty - LNG", "Excise Duty - LNG Mix"), Parameter := "Excise Duty"]
plotdata <- plotdata[, Parameter := factor(Parameter, levels = c( "Total Mark-Up", "CO2 Tax", "Excise Duty", "Wholesale Price"))]
plotdata[, `Type` := factor(`Type`, levels = c("Fossil LNG", "Bio Gas", "PT LNG", "LNG Mix"))]
plotdata[period == 2020 & Type == "PT LNG", value := 0]

p <- ggplot(plotdata[Country %in% Countries_plotted & period %in% yrs], aes(fill=Parameter, y=value, x=`Type`)) + theme(panel.grid.major=element_line(colour='#adadad'), panel.grid.minor=element_line(colour='#adadad')) +
    geom_bar(position="stack", stat="identity")+
      facet_wrap(`Fuel-Scenario` ~ period, nrow = 1, scales = "free")+
      facet_grid(`Fuel-Scenario` ~ period) + theme_bw()+
      theme(text = element_text(size = textSize))+
      scale_x_discrete(labels=function(x){sub("\\s", "\n", x)}) +
      labs(y = paste0("Diesel Prices [EUR/kWh]")) + #, title = "Diesel Mix Prices") +
      scale_fill_manual(values=colorbarDie)
plot(p)

```

## Comparison plots LNG: Fossil vs Bio vs Syn vs Mix [EUR/kg]
```{r , include=TRUE, fig.width = 30,fig.height = 10}
yrs <- c(2020, 2030, 2035, 2040)
LNG_kWh_pro_kg <- 12.53

plotdata <- rbind(BioLNG,PtLNG, LNG, LNG_Mix)
plotdata[, value := value*LNG_kWh_pro_kg][, unit := "EUR/kg"]
plotdata[Parameter %in% c("Total NG Mark-Up"), Parameter := "Total Mark-Up"]
plotdata[Parameter %in% c("Wholesale Biogas Price", "Wholesale Pt-LNG Price", "Wholesale LNG Price", "Wholesale LNG Price (Mix)"), Parameter := "Wholesale Price"]
plotdata[Parameter %in% c("CO2 Tax Biogas", "CO2 Tax Pt-LNG", "CO2 Tax LNG", "CO2 Tax LNG Mix"), Parameter := "CO2 Tax"]
plotdata[Parameter %in% c("Excise Duty - biogas", "Excise Duty - Pt-LNG", "Excise Duty - LNG", "Excise Duty - LNG Mix"), Parameter := "Excise Duty"]
plotdata <- plotdata[, Parameter := factor(Parameter, levels = c( "Total Mark-Up", "CO2 Tax", "Excise Duty", "Wholesale Price"))]
plotdata[, `Type` := factor(`Type`, levels = c("Fossil LNG", "Bio Gas", "PT LNG", "LNG Mix"))]
plotdata[period == 2020 & Type == "PT LNG", value := 0]

p <- ggplot(plotdata[Country %in% Countries_plotted & period %in% yrs], aes(fill=Parameter, y=value, x=`Type`)) + theme(panel.grid.major=element_line(colour='#adadad'), panel.grid.minor=element_line(colour='#adadad')) +
    geom_bar(position="stack", stat="identity")+
      facet_wrap(`Fuel-Scenario` ~ period, nrow = 1, scales = "free")+
      facet_grid(`Fuel-Scenario` ~ period) + theme_bw()+
      theme(text = element_text(size = textSize))+
      scale_x_discrete(labels=function(x){sub("\\s", "\n", x)}) +
      labs(y = paste0("LNG Prices [EUR/kg]")) + #, title = "Diesel Mix Prices") +
      scale_fill_manual(values=colorbarDie)
plot(p)

```

# Netherlands
## Hydrogen Enduse Prices [EUR/kWh]
```{r , include=TRUE, fig.width = 30,fig.height = 10}
Countries_plotted <- c("NL")
yrs <- c(2030, 2040, 2050)
```

```{r , include=TRUE, fig.width = 30,fig.height = 10}
p <- ggplot(Hydrogen[Country %in% Countries_plotted & period %in% yrs], aes(fill=Parameter, y=value, x=`period`)) + theme(panel.grid.major=element_line(colour='#adadad'), panel.grid.minor=element_line(colour='#adadad')) +
    geom_bar(position="stack", stat="identity")+
      facet_grid(~ `Fuel-Scenario`, scales = "free")+
      theme(text = element_text(size = textSize))+
      labs(y = paste0("Hydrogen Price [EUR/kWh]")) + #, title = "Hydrogen Prices for different Fuel Scenarios") +
      scale_x_continuous(breaks = c(2030, 2040, 2050)) +
      scale_fill_manual(values=colorbarHydrogen)
plot(p)

```

## Hydrogen Enduse Prices [EUR/kg]
```{r , include=TRUE, fig.width = 30,fig.height = 10}
HydrogenKg <- copy(Hydrogen)
HydrogenKg[, `kWh/kg H2` := 33.33]
HydrogenKg[, value := value*`kWh/kg H2`][, unit := "EUR/kg"]

p <- ggplot(HydrogenKg[Country %in% Countries_plotted & period %in% yrs], aes(fill=Parameter, y=value, x=`period`)) + theme(panel.grid.major=element_line(colour='#adadad'), panel.grid.minor=element_line(colour='#adadad')) +
    geom_bar(position="stack", stat="identity")+
      facet_grid(~ `Fuel-Scenario`, scales = "free")+
      theme(text = element_text(size = textSize))+
      labs(y = paste0("Hydrogen Price [EUR/kg]")) + #, title = "Hydrogen Prices for different Fuel Scenarios") +
      scale_x_continuous(breaks = c(2030, 2040, 2050)) +
      scale_fill_manual(values=colorbarHydrogen)
plot(p)

```

## Electricity Enduse Prices Depot Charging [EUR/kWh]
```{r , include=TRUE, fig.width = 30,fig.height = 10}
p <- ggplot(Electricity_Depot[Country %in% Countries_plotted & period %in% yrs], aes(fill=Parameter, y=value, x=`period`)) + theme(panel.grid.major=element_line(colour='#adadad'), panel.grid.minor=element_line(colour='#adadad')) +
    geom_bar(position="stack", stat="identity")+
      facet_grid(~ `Fuel-Scenario`, scales = "free")+
      theme(text = element_text(size = textSize))+
      labs(y = paste0("Enduse Electricity Price [EUR/kWh]")) + #, title = "Electricity Prices Depot Charging") +
      scale_x_continuous(breaks = c(2030, 2040, 2050)) +
      scale_fill_manual(values=colorbarElec_CCS)
plot(p)

```

## Electricity Enduse Prices MCS Charging [EUR/kWh]
```{r , include=TRUE, fig.width = 30,fig.height = 10}
p <- ggplot(Electricity_MCS[Country %in% Countries_plotted & period %in% yrs], aes(fill=Parameter, y=value, x=`period`)) + theme(panel.grid.major=element_line(colour='#adadad'), panel.grid.minor=element_line(colour='#adadad')) +
    geom_bar(position="stack", stat="identity")+
      facet_grid(~ `Fuel-Scenario`, scales = "free")+
      theme(text = element_text(size = textSize))+
      labs(y = paste0("Enduse Electricity Price [EUR/kWh]")) + #, title = "Electricity Prices MCS Charging") +
      scale_x_continuous(breaks = c(2030, 2040, 2050)) +
      scale_fill_manual(values=colorbarElec_MCS)
plot(p)

```

## Diesel Mix Enduse Prices [EUR/kWh]
```{r , include=TRUE, fig.width = 30,fig.height = 10}
p <- ggplot(Diesel_Mix[Country %in% Countries_plotted & period %in% yrs], aes(fill=Parameter, y=value, x=`period`)) + theme(panel.grid.major=element_line(colour='#adadad'), panel.grid.minor=element_line(colour='#adadad')) +
    geom_bar(position="stack", stat="identity")+
      facet_grid(~ `Fuel-Scenario`, scales = "free")+
      theme(text = element_text(size = textSize))+
      labs(y = paste0("Enduse Diesel Mix Price [EUR/kWh]")) + #, title = "Diesel Mix Prices") +
      scale_x_continuous(breaks = c(2030, 2040, 2050)) +
      scale_fill_manual(values=colorbarDie)
plot(p)

```

## Fossil Diesel Enduse Prices [EUR/kWh]
```{r , include=TRUE, fig.width = 30,fig.height = 10}
p <- ggplot(Diesel[Country %in% Countries_plotted & period %in% yrs], aes(fill=Parameter, y=value, x=`period`)) + theme(panel.grid.major=element_line(colour='#adadad'), panel.grid.minor=element_line(colour='#adadad')) +
    geom_bar(position="stack", stat="identity")+
      facet_grid(~ `Fuel-Scenario`, scales = "free")+
      theme(text = element_text(size = textSize))+
      labs(y = paste0("Enduse Fossil Diesel Price [EUR/kWh]")) + #, title = "Diesel Mix Prices") +
      scale_x_continuous(breaks = c(2030, 2040, 2050)) +
      scale_fill_manual(values=colorbarDie)
plot(p)

```

## Pt-Diesel Enduse Prices [EUR/kWh]
```{r , include=TRUE, fig.width = 30,fig.height = 10}
p <- ggplot(PtDiesel[Country %in% Countries_plotted & period %in% yrs], aes(fill=Parameter, y=value, x=`period`)) + theme(panel.grid.major=element_line(colour='#adadad'), panel.grid.minor=element_line(colour='#adadad')) +
    geom_bar(position="stack", stat="identity")+
      facet_grid(~ `Fuel-Scenario`, scales = "free")+
      theme(text = element_text(size = textSize))+
      labs(y = paste0("Enduse Pt-Diesel Price [EUR/kWh]")) + #, title = "Diesel Mix Prices") +
      scale_x_continuous(breaks = c(2030, 2040, 2050)) +
      scale_fill_manual(values=colorbarDie)
plot(p)

```

## Biodiesel Enduse Prices [EUR/kWh]
```{r , include=TRUE, fig.width = 30,fig.height = 10}
p <- ggplot(BioDiesel[Country %in% Countries_plotted & period %in% yrs], aes(fill=Parameter, y=value, x=`period`)) + theme(panel.grid.major=element_line(colour='#adadad'), panel.grid.minor=element_line(colour='#adadad')) +
    geom_bar(position="stack", stat="identity")+
      facet_grid(~ `Fuel-Scenario`, scales = "free")+
      theme(text = element_text(size = textSize))+
      labs(y = paste0("Enduse Biodiesel Price [EUR/kWh]")) + #, title = "Diesel Mix Prices") +
      scale_x_continuous(breaks = c(2030, 2040, 2050)) +
      scale_fill_manual(values=colorbarDie)
plot(p)

```

## LNG Mix Enduse Prices [EUR/kWh]
```{r , include=TRUE, fig.width = 30,fig.height = 10}
p <- ggplot(LNG_Mix[Country %in% Countries_plotted & period %in% yrs], aes(fill=Parameter, y=value, x=`period`)) + theme(panel.grid.major=element_line(colour='#adadad'), panel.grid.minor=element_line(colour='#adadad')) +
    geom_bar(position="stack", stat="identity")+
      facet_grid(~ `Fuel-Scenario`, scales = "free")+
      theme(text = element_text(size = textSize))+
      labs(y = paste0("Enduse LNG Mix Price [EUR/kWh]")) + #, title = "LNG Mix Prices") +
      scale_x_continuous(breaks = c(2030, 2040, 2050)) +
      scale_fill_manual(values=colorbarLNG)
plot(p)
```

## Fossil LNG Enduse Prices [EUR/kWh]
```{r , include=TRUE, fig.width = 30,fig.height = 10}
p <- ggplot(LNG[Country %in% Countries_plotted & period %in% yrs], aes(fill=Parameter, y=value, x=`period`)) + theme(panel.grid.major=element_line(colour='#adadad'), panel.grid.minor=element_line(colour='#adadad')) +
    geom_bar(position="stack", stat="identity")+
      facet_grid(~ `Fuel-Scenario`, scales = "free")+
      theme(text = element_text(size = textSize))+
      labs(y = paste0("Enduse Fossil LNG Price [EUR/kWh]")) + #, title = "Diesel Mix Prices") +
      scale_x_continuous(breaks = c(2030, 2040, 2050)) +
      scale_fill_manual(values=colorbarDie)
plot(p)

```

## Pt-LNG Enduse Prices [EUR/kWh]
```{r , include=TRUE, fig.width = 30,fig.height = 10}
p <- ggplot(PtLNG[Country %in% Countries_plotted & period %in% yrs], aes(fill=Parameter, y=value, x=`period`)) + theme(panel.grid.major=element_line(colour='#adadad'), panel.grid.minor=element_line(colour='#adadad')) +
    geom_bar(position="stack", stat="identity")+
      facet_grid(~ `Fuel-Scenario`, scales = "free")+
      theme(text = element_text(size = textSize))+
      labs(y = paste0("Enduse Pt-LNG Price [EUR/kWh]")) + #, title = "Diesel Mix Prices") +
      scale_x_continuous(breaks = c(2030, 2040, 2050)) +
      scale_fill_manual(values=colorbarDie)
plot(p)

```

## Biogas Enduse Prices [EUR/kWh]
```{r , include=TRUE, fig.width = 30,fig.height = 10}
p <- ggplot(BioLNG[Country %in% Countries_plotted & period %in% yrs], aes(fill=Parameter, y=value, x=`period`)) + theme(panel.grid.major=element_line(colour='#adadad'), panel.grid.minor=element_line(colour='#adadad')) +
    geom_bar(position="stack", stat="identity")+
      facet_grid(~ `Fuel-Scenario`, scales = "free")+
      theme(text = element_text(size = textSize))+
      labs(y = paste0("Enduse Biogas Price [EUR/kWh]")) + #, title = "Diesel Mix Prices") +
      scale_x_continuous(breaks = c(2030, 2040, 2050)) +
      scale_fill_manual(values=colorbarDie)
plot(p)

```

## Comparison plots Diesel: Fossil vs Bio vs Syn vs Mix [EUR/kWh]
```{r , include=TRUE, fig.width = 30,fig.height = 10}

yrs <- c(2020, 2030, 2035, 2040)
plotdata <- rbind(BioDiesel,PtDiesel, Diesel, Diesel_Mix)
plotdata[Parameter %in% c("Total Diesel Mark-Up"), Parameter := "Total Mark-Up"]
plotdata[Parameter %in% c("Wholesale Biodiesel Price", "Wholesale PT-Diesel Price", "Wholesale Diesel Price", "Wholesale Diesel Price (Mix)"), Parameter := "Wholesale Price"]
plotdata[Parameter %in% c("CO2 Tax Biodiesel", "CO2 Tax Pt-Diesel", "CO2 Tax Diesel", "CO2 Tax Diesel Mix"), Parameter := "CO2 Tax"]
plotdata[Parameter %in% c("Excise Duty - biodiesel", "Excise Duty - Synthetic Diesel (E-Fuels)", "Excise Duty - Diesel", "Excise Duty - Diesel Mix"), Parameter := "Excise Duty"]
plotdata <- plotdata[, Parameter := factor(Parameter, levels = c( "Total Mark-Up", "CO2 Tax", "Excise Duty", "Wholesale Price"))]
plotdata[, `Type` := factor(`Type`, levels = c("Fossil Diesel", "Bio Diesel", "PT Diesel", "Diesel Mix"))]
plotdata[period == 2020 & Type == "PT Diesel", value := 0]

p <- ggplot(plotdata[Country %in% Countries_plotted & period %in% yrs], aes(fill=Parameter, y=value, x=`Type`)) + theme(panel.grid.major=element_line(colour='#adadad'), panel.grid.minor=element_line(colour='#adadad')) +
    geom_bar(position="stack", stat="identity")+
      facet_wrap(`Fuel-Scenario` ~ period, nrow = 1, scales = "free")+
      facet_grid(`Fuel-Scenario` ~ period) + theme_bw()+
      theme(text = element_text(size = textSize))+
      scale_x_discrete(labels=function(x){sub("\\s", "\n", x)}) +
      labs(y = paste0("Diesel Prices [EUR/kWh]")) + #, title = "Diesel Mix Prices") +
      scale_fill_manual(values=colorbarDie)
plot(p)

```

## Comparison plots Diesel: Fossil vs Bio vs Syn vs Mix [EUR/l]
```{r , include=TRUE, fig.width = 30,fig.height = 10}
Diesel_kWh_pro_l <- 9.97
BioDiesel_kWh_pro_l <- 9.11

yrs <- c(2020, 2030, 2035, 2040)
plotdata <- rbind(BioDiesel,PtDiesel, Diesel, Diesel_Mix)
plotdata[, value := ifelse(Type== "Biodiesel", value*BioDiesel_kWh_pro_l, value*Diesel_kWh_pro_l)][, unit := "EUR/l"]
plotdata[Parameter %in% c("Total Diesel Mark-Up"), Parameter := "Total Mark-Up"]
plotdata[Parameter %in% c("Wholesale Biodiesel Price", "Wholesale PT-Diesel Price", "Wholesale Diesel Price", "Wholesale Diesel Price (Mix)"), Parameter := "Wholesale Price"]
plotdata[Parameter %in% c("CO2 Tax Biodiesel", "CO2 Tax Pt-Diesel", "CO2 Tax Diesel", "CO2 Tax Diesel Mix"), Parameter := "CO2 Tax"]
plotdata[Parameter %in% c("Excise Duty - biodiesel", "Excise Duty - Synthetic Diesel (E-Fuels)", "Excise Duty - Diesel", "Excise Duty - Diesel Mix"), Parameter := "Excise Duty"]
plotdata <- plotdata[, Parameter := factor(Parameter, levels = c( "Total Mark-Up", "CO2 Tax", "Excise Duty", "Wholesale Price"))]
plotdata[, `Type` := factor(`Type`, levels = c("Fossil Diesel", "Bio Diesel", "PT Diesel", "Diesel Mix"))]
#Set PT-Diesel Price to zero in 2020 because there is not quantity
plotdata[period == 2020 & Type == "PT Diesel", value := 0]

p <- ggplot(plotdata[Country %in% Countries_plotted & period %in% yrs], aes(fill=Parameter, y=value, x=`Type`)) + theme(panel.grid.major=element_line(colour='#adadad'), panel.grid.minor=element_line(colour='#adadad')) +
    geom_bar(position="stack", stat="identity")+
      facet_wrap(`Fuel-Scenario` ~ period, nrow = 1, scales = "free")+
      facet_grid(`Fuel-Scenario` ~ period) + theme_bw()+
      theme(text = element_text(size = textSize))+
      scale_x_discrete(labels=function(x){sub("\\s", "\n", x)}) +
      labs(y = paste0("Diesel Prices [EUR/l]")) + #, title = "Diesel Mix Prices") +
      scale_fill_manual(values=colorbarDie)
plot(p)

```

## Comparison plots LNG: Fossil vs Bio vs Syn vs Mix [EUR/kWh]
```{r , include=TRUE, fig.width = 30,fig.height = 10}

yrs <- c(2020, 2030, 2035, 2040)
plotdata <- rbind(BioLNG,PtLNG, LNG, LNG_Mix)
plotdata[Parameter %in% c("Total NG Mark-Up"), Parameter := "Total Mark-Up"]
plotdata[Parameter %in% c("Wholesale Biogas Price", "Wholesale Pt-LNG Price", "Wholesale LNG Price", "Wholesale LNG Price (Mix)"), Parameter := "Wholesale Price"]
plotdata[Parameter %in% c("CO2 Tax Biogas", "CO2 Tax Pt-LNG", "CO2 Tax LNG", "CO2 Tax LNG Mix"), Parameter := "CO2 Tax"]
plotdata[Parameter %in% c("Excise Duty - biogas", "Excise Duty - Pt-LNG", "Excise Duty - LNG", "Excise Duty - LNG Mix"), Parameter := "Excise Duty"]
plotdata <- plotdata[, Parameter := factor(Parameter, levels = c( "Total Mark-Up", "CO2 Tax", "Excise Duty", "Wholesale Price"))]
plotdata[, `Type` := factor(`Type`, levels = c("Fossil LNG", "Bio Gas", "PT LNG", "LNG Mix"))]
plotdata[period == 2020 & Type == "PT LNG", value := 0]

p <- ggplot(plotdata[Country %in% Countries_plotted & period %in% yrs], aes(fill=Parameter, y=value, x=`Type`)) + theme(panel.grid.major=element_line(colour='#adadad'), panel.grid.minor=element_line(colour='#adadad')) +
    geom_bar(position="stack", stat="identity")+
      facet_wrap(`Fuel-Scenario` ~ period, nrow = 1, scales = "free")+
      facet_grid(`Fuel-Scenario` ~ period) + theme_bw()+
      theme(text = element_text(size = textSize))+
      scale_x_discrete(labels=function(x){sub("\\s", "\n", x)}) +
      labs(y = paste0("Diesel Prices [EUR/kWh]")) + #, title = "Diesel Mix Prices") +
      scale_fill_manual(values=colorbarDie)
plot(p)

```

## Comparison plots LNG: Fossil vs Bio vs Syn vs Mix [EUR/kg]
```{r , include=TRUE, fig.width = 30,fig.height = 10}
yrs <- c(2020, 2030, 2035, 2040)
LNG_kWh_pro_kg <- 12.53

plotdata <- rbind(BioLNG,PtLNG, LNG, LNG_Mix)
plotdata[, value := value*LNG_kWh_pro_kg][, unit := "EUR/kg"]
plotdata[Parameter %in% c("Total NG Mark-Up"), Parameter := "Total Mark-Up"]
plotdata[Parameter %in% c("Wholesale Biogas Price", "Wholesale Pt-LNG Price", "Wholesale LNG Price", "Wholesale LNG Price (Mix)"), Parameter := "Wholesale Price"]
plotdata[Parameter %in% c("CO2 Tax Biogas", "CO2 Tax Pt-LNG", "CO2 Tax LNG", "CO2 Tax LNG Mix"), Parameter := "CO2 Tax"]
plotdata[Parameter %in% c("Excise Duty - biogas", "Excise Duty - Pt-LNG", "Excise Duty - LNG", "Excise Duty - LNG Mix"), Parameter := "Excise Duty"]
plotdata <- plotdata[, Parameter := factor(Parameter, levels = c( "Total Mark-Up", "CO2 Tax", "Excise Duty", "Wholesale Price"))]
plotdata[, `Type` := factor(`Type`, levels = c("Fossil LNG", "Bio Gas", "PT LNG", "LNG Mix"))]
plotdata[period == 2020 & Type == "PT LNG", value := 0]

p <- ggplot(plotdata[Country %in% Countries_plotted & period %in% yrs], aes(fill=Parameter, y=value, x=`Type`)) + theme(panel.grid.major=element_line(colour='#adadad'), panel.grid.minor=element_line(colour='#adadad')) +
    geom_bar(position="stack", stat="identity")+
      facet_wrap(`Fuel-Scenario` ~ period, nrow = 1, scales = "free")+
      facet_grid(`Fuel-Scenario` ~ period) + theme_bw()+
      theme(text = element_text(size = textSize))+
      scale_x_discrete(labels=function(x){sub("\\s", "\n", x)}) +
      labs(y = paste0("LNG Prices [EUR/kg]")) + #, title = "Diesel Mix Prices") +
      scale_fill_manual(values=colorbarDie)
plot(p)

```